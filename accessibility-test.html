<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ ë„êµ¬ - CHARM_INYEON</title>
    <link rel="stylesheet" href="senior-styles.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }

        .test-section {
            background: var(--bg-primary);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            box-shadow: var(--shadow-sm);
        }

        .test-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
        }

        .test-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .test-result {
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            font-size: var(--font-size-small);
        }

        .test-result.pass {
            background: var(--success-color);
            color: white;
        }

        .test-result.fail {
            background: var(--error-color);
            color: white;
        }

        .test-result.warning {
            background: var(--warning-color);
            color: white;
        }

        .test-controls {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .test-log {
            background: var(--text-primary);
            color: white;
            padding: var(--spacing-lg);
            border-radius: var(--border-radius-md);
            font-family: monospace;
            font-size: var(--font-size-small);
            line-height: 1.6;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .summary-card {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .summary-item {
            text-align: center;
            background: var(--bg-secondary);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius-md);
        }

        .summary-number {
            font-size: var(--font-size-xxl);
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
        }

        .summary-label {
            font-size: var(--font-size-base);
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <header style="text-align: center; margin-bottom: var(--spacing-xl);">
            <h1 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">
                ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ ë„êµ¬
            </h1>
            <p style="color: var(--text-secondary);">
                ì¤‘ì¥ë…„ì¸µ ì¹œí™”ì  UI/UXì˜ ì ‘ê·¼ì„±ê³¼ ì‚¬ìš©ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤
            </p>
        </header>

        <!-- í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì»¨íŠ¸ë¡¤ -->
        <div class="test-controls">
            <button id="runAllTests" class="btn btn-primary btn-large">
                <span>ğŸ” ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</span>
            </button>
            <button id="clearResults" class="btn btn-secondary" style="margin-left: var(--spacing-md);">
                <span>ğŸ—‘ï¸ ê²°ê³¼ ì´ˆê¸°í™”</span>
            </button>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½ -->
        <div id="testSummary" class="summary-card" style="display: none;">
            <div class="summary-item">
                <div class="summary-number" id="passCount" style="color: var(--success-color);">0</div>
                <div class="summary-label">í†µê³¼</div>
            </div>
            <div class="summary-item">
                <div class="summary-number" id="warningCount" style="color: var(--warning-color);">0</div>
                <div class="summary-label">ê²½ê³ </div>
            </div>
            <div class="summary-item">
                <div class="summary-number" id="failCount" style="color: var(--error-color);">0</div>
                <div class="summary-label">ì‹¤íŒ¨</div>
            </div>
            <div class="summary-item">
                <div class="summary-number" id="totalScore" style="color: var(--primary-color);">0%</div>
                <div class="summary-label">ì „ì²´ ì ìˆ˜</div>
            </div>
        </div>

        <!-- ìƒ‰ìƒ ëŒ€ë¹„ í…ŒìŠ¤íŠ¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">ìƒ‰ìƒ ëŒ€ë¹„ í…ŒìŠ¤íŠ¸</h2>
            <div id="colorContrastTests">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- ê¸€ê¼´ í¬ê¸° í…ŒìŠ¤íŠ¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">ê¸€ê¼´ í¬ê¸° í…ŒìŠ¤íŠ¸</h2>
            <div id="fontSizeTests">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- í„°ì¹˜ íƒ€ê²Ÿ í¬ê¸° í…ŒìŠ¤íŠ¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">í„°ì¹˜ íƒ€ê²Ÿ í¬ê¸° í…ŒìŠ¤íŠ¸</h2>
            <div id="touchTargetTests">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸</h2>
            <div id="keyboardTests">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- ì˜ë¯¸ë¡ ì  ë§ˆí¬ì—… í…ŒìŠ¤íŠ¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">ì˜ë¯¸ë¡ ì  ë§ˆí¬ì—… í…ŒìŠ¤íŠ¸</h2>
            <div id="semanticTests">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- ARIA ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">ARIA ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸</h2>
            <div id="ariaTests">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </section>

        <!-- í…ŒìŠ¤íŠ¸ ë¡œê·¸ -->
        <section class="test-section">
            <h2 style="color: var(--primary-color); margin-bottom: var(--spacing-md);">ìƒì„¸ í…ŒìŠ¤íŠ¸ ë¡œê·¸</h2>
            <div id="testLog" class="test-log">
í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ì—¬ê¸°ì— ìƒì„¸í•œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </section>
    </div>

    <script>
        class AccessibilityTester {
            constructor() {
                this.testResults = {
                    pass: 0,
                    warning: 0,
                    fail: 0,
                    total: 0
                };
                this.log = [];
                this.init();
            }

            init() {
                document.getElementById('runAllTests').addEventListener('click', () => {
                    this.runAllTests();
                });

                document.getElementById('clearResults').addEventListener('click', () => {
                    this.clearResults();
                });
            }

            async runAllTests() {
                this.clearResults();
                this.logMessage('ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...\n');

                // ê° ì¹´í…Œê³ ë¦¬ë³„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                await this.testColorContrast();
                await this.testFontSizes();
                await this.testTouchTargets();
                await this.testKeyboardNavigation();
                await this.testSemanticMarkup();
                await this.testARIA();

                this.updateSummary();
                this.logMessage('\nâœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            clearResults() {
                this.testResults = { pass: 0, warning: 0, fail: 0, total: 0 };
                this.log = [];
                
                // ê²°ê³¼ ì˜ì—­ ì´ˆê¸°í™”
                const testSections = ['colorContrastTests', 'fontSizeTests', 'touchTargetTests', 'keyboardTests', 'semanticTests', 'ariaTests'];
                testSections.forEach(section => {
                    document.getElementById(section).innerHTML = '';
                });

                document.getElementById('testLog').textContent = 'í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ì—¬ê¸°ì— ìƒì„¸í•œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.';
                document.getElementById('testSummary').style.display = 'none';
            }

            async testColorContrast() {
                this.logMessage('ğŸ¨ ìƒ‰ìƒ ëŒ€ë¹„ í…ŒìŠ¤íŠ¸ ì¤‘...');
                const container = document.getElementById('colorContrastTests');

                const colorTests = [
                    { name: 'ê¸°ë³¸ í…ìŠ¤íŠ¸', bg: '#FFFFFF', fg: '#2D3748', minRatio: 4.5 },
                    { name: 'ë³´ì¡° í…ìŠ¤íŠ¸', bg: '#F8F9FF', fg: '#4A5568', minRatio: 4.5 },
                    { name: 'ë²„íŠ¼ í…ìŠ¤íŠ¸', bg: '#6B73FF', fg: '#FFFFFF', minRatio: 4.5 },
                    { name: 'ë§í¬ í…ìŠ¤íŠ¸', bg: '#FFFFFF', fg: '#6B73FF', minRatio: 4.5 },
                    { name: 'ì—ëŸ¬ í…ìŠ¤íŠ¸', bg: '#FFFFFF', fg: '#EF5350', minRatio: 4.5 }
                ];

                colorTests.forEach(test => {
                    const ratio = this.calculateContrastRatio(test.bg, test.fg);
                    const passed = ratio >= test.minRatio;
                    
                    this.addTestResult(container, test.name, 
                        `ëŒ€ë¹„ìœ¨: ${ratio.toFixed(2)}:1 (ìµœì†Œ: ${test.minRatio}:1)`, 
                        passed ? 'pass' : 'fail'
                    );

                    this.updateTestCount(passed ? 'pass' : 'fail');
                    this.logMessage(`  - ${test.name}: ${ratio.toFixed(2)}:1 ${passed ? 'âœ…' : 'âŒ'}`);
                });
            }

            async testFontSizes() {
                this.logMessage('ğŸ“ ê¸€ê¼´ í¬ê¸° í…ŒìŠ¤íŠ¸ ì¤‘...');
                const container = document.getElementById('fontSizeTests');

                const fontTests = [
                    { name: 'ê¸°ë³¸ í…ìŠ¤íŠ¸', selector: 'body', minSize: 16 },
                    { name: 'ì œëª© (h1)', selector: 'h1', minSize: 32 },
                    { name: 'ì œëª© (h2)', selector: 'h2', minSize: 26 },
                    { name: 'ë²„íŠ¼ í…ìŠ¤íŠ¸', selector: '.btn', minSize: 16 },
                    { name: 'í¼ ì…ë ¥', selector: '.form-input', minSize: 16 }
                ];

                fontTests.forEach(test => {
                    const element = document.querySelector(test.selector);
                    if (element) {
                        const fontSize = parseInt(window.getComputedStyle(element).fontSize);
                        const passed = fontSize >= test.minSize;
                        
                        this.addTestResult(container, test.name, 
                            `í˜„ì¬: ${fontSize}px (ìµœì†Œ: ${test.minSize}px)`, 
                            passed ? 'pass' : 'fail'
                        );

                        this.updateTestCount(passed ? 'pass' : 'fail');
                        this.logMessage(`  - ${test.name}: ${fontSize}px ${passed ? 'âœ…' : 'âŒ'}`);
                    } else {
                        this.addTestResult(container, test.name, 'ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'warning');
                        this.updateTestCount('warning');
                        this.logMessage(`  - ${test.name}: ìš”ì†Œ ì—†ìŒ âš ï¸`);
                    }
                });
            }

            async testTouchTargets() {
                this.logMessage('ğŸ‘† í„°ì¹˜ íƒ€ê²Ÿ í¬ê¸° í…ŒìŠ¤íŠ¸ ì¤‘...');
                const container = document.getElementById('touchTargetTests');

                const interactiveElements = document.querySelectorAll('button, a, input, select, textarea');
                let passed = 0;
                let failed = 0;

                interactiveElements.forEach((element, index) => {
                    const rect = element.getBoundingClientRect();
                    const minSize = 44; // WCAG ê¶Œì¥ ìµœì†Œ í¬ê¸°
                    const isValidSize = rect.width >= minSize && rect.height >= minSize;
                    
                    if (index < 10) { // ì²˜ìŒ 10ê°œë§Œ í‘œì‹œ
                        const tagName = element.tagName.toLowerCase();
                        const className = element.className || 'no-class';
                        
                        this.addTestResult(container, 
                            `${tagName}.${className}`, 
                            `í¬ê¸°: ${Math.round(rect.width)}Ã—${Math.round(rect.height)}px (ìµœì†Œ: ${minSize}Ã—${minSize}px)`, 
                            isValidSize ? 'pass' : 'fail'
                        );
                    }

                    if (isValidSize) {
                        passed++;
                    } else {
                        failed++;
                    }
                });

                this.updateTestCount('pass', passed);
                this.updateTestCount('fail', failed);
                this.logMessage(`  - í†µê³¼: ${passed}ê°œ, ì‹¤íŒ¨: ${failed}ê°œ`);
            }

            async testKeyboardNavigation() {
                this.logMessage('âŒ¨ï¸ í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸ ì¤‘...');
                const container = document.getElementById('keyboardTests');

                const tests = [
                    {
                        name: 'Tab ìˆœì„œ',
                        test: () => {
                            const focusableElements = document.querySelectorAll(
                                'a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])'
                            );
                            return focusableElements.length > 0;
                        }
                    },
                    {
                        name: 'í¬ì»¤ìŠ¤ í‘œì‹œ',
                        test: () => {
                            // CSSì—ì„œ :focus ìŠ¤íƒ€ì¼ì´ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
                            const styles = Array.from(document.styleSheets).some(sheet => {
                                try {
                                    return Array.from(sheet.cssRules).some(rule => 
                                        rule.selectorText && rule.selectorText.includes(':focus')
                                    );
                                } catch (e) {
                                    return false;
                                }
                            });
                            return styles;
                        }
                    },
                    {
                        name: 'Skip Link',
                        test: () => {
                            return document.querySelector('a[href^="#"]') !== null;
                        }
                    },
                    {
                        name: 'Enter í‚¤ ì§€ì›',
                        test: () => {
                            const buttons = document.querySelectorAll('button');
                            return buttons.length > 0; // ê°„ë‹¨í•œ ì²´í¬
                        }
                    }
                ];

                tests.forEach(test => {
                    const result = test.test();
                    this.addTestResult(container, test.name, 
                        result ? 'ì§€ì›ë¨' : 'ì§€ì›ë˜ì§€ ì•ŠìŒ', 
                        result ? 'pass' : 'fail'
                    );
                    this.updateTestCount(result ? 'pass' : 'fail');
                    this.logMessage(`  - ${test.name}: ${result ? 'âœ…' : 'âŒ'}`);
                });
            }

            async testSemanticMarkup() {
                this.logMessage('ğŸ—ï¸ ì˜ë¯¸ë¡ ì  ë§ˆí¬ì—… í…ŒìŠ¤íŠ¸ ì¤‘...');
                const container = document.getElementById('semanticTests');

                const semanticTests = [
                    { name: 'HTML5 DOCTYPE', test: () => document.doctype && document.doctype.name === 'html' },
                    { name: 'lang ì†ì„±', test: () => document.documentElement.hasAttribute('lang') },
                    { name: 'main ìš”ì†Œ', test: () => document.querySelector('main') !== null },
                    { name: 'nav ìš”ì†Œ', test: () => document.querySelector('nav') !== null },
                    { name: 'header ìš”ì†Œ', test: () => document.querySelector('header') !== null },
                    { name: 'h1 ìš”ì†Œ', test: () => document.querySelector('h1') !== null },
                    { name: 'ì œëª© êµ¬ì¡°', test: () => this.checkHeadingStructure() },
                    { name: 'alt ì†ì„±', test: () => this.checkAltAttributes() }
                ];

                semanticTests.forEach(test => {
                    const result = test.test();
                    this.addTestResult(container, test.name, 
                        result ? 'ì ì ˆí•¨' : 'ê°œì„  í•„ìš”', 
                        result ? 'pass' : 'fail'
                    );
                    this.updateTestCount(result ? 'pass' : 'fail');
                    this.logMessage(`  - ${test.name}: ${result ? 'âœ…' : 'âŒ'}`);
                });
            }

            async testARIA() {
                this.logMessage('â™¿ ARIA ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ ì¤‘...');
                const container = document.getElementById('ariaTests');

                const ariaTests = [
                    {
                        name: 'aria-label ì‚¬ìš©',
                        test: () => document.querySelectorAll('[aria-label]').length > 0
                    },
                    {
                        name: 'aria-labelledby ì‚¬ìš©',
                        test: () => document.querySelectorAll('[aria-labelledby]').length > 0
                    },
                    {
                        name: 'aria-hidden ì‚¬ìš©',
                        test: () => document.querySelectorAll('[aria-hidden]').length > 0
                    },
                    {
                        name: 'role ì†ì„± ì‚¬ìš©',
                        test: () => document.querySelectorAll('[role]').length > 0
                    },
                    {
                        name: 'aria-expanded ì‚¬ìš©',
                        test: () => document.querySelectorAll('[aria-expanded]').length > 0
                    },
                    {
                        name: 'aria-live ì˜ì—­',
                        test: () => document.querySelectorAll('[aria-live]').length > 0
                    }
                ];

                ariaTests.forEach(test => {
                    const result = test.test();
                    this.addTestResult(container, test.name, 
                        result ? 'ì‚¬ìš©ë¨' : 'ì‚¬ìš©ë˜ì§€ ì•ŠìŒ', 
                        result ? 'pass' : 'warning'
                    );
                    this.updateTestCount(result ? 'pass' : 'warning');
                    this.logMessage(`  - ${test.name}: ${result ? 'âœ…' : 'âš ï¸'}`);
                });
            }

            calculateContrastRatio(bg, fg) {
                // ê°„ë‹¨í•œ ëŒ€ë¹„ìœ¨ ê³„ì‚° (ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ ì•Œê³ ë¦¬ì¦˜ í•„ìš”)
                const getLuminance = (color) => {
                    const rgb = parseInt(color.substring(1), 16);
                    const r = (rgb >> 16) & 0xff;
                    const g = (rgb >> 8) & 0xff;
                    const b = (rgb >> 0) & 0xff;
                    return (0.299 * r + 0.587 * g + 0.114 * b) / 255;
                };

                const bgLum = getLuminance(bg);
                const fgLum = getLuminance(fg);
                const brightest = Math.max(bgLum, fgLum);
                const darkest = Math.min(bgLum, fgLum);
                
                return (brightest + 0.05) / (darkest + 0.05);
            }

            checkHeadingStructure() {
                const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
                if (headings.length === 0) return false;
                
                let previousLevel = 0;
                for (let heading of headings) {
                    const level = parseInt(heading.tagName.substring(1));
                    if (previousLevel === 0) {
                        if (level !== 1) return false; // ì²« ì œëª©ì€ h1ì´ì–´ì•¼ í•¨
                    } else if (level > previousLevel + 1) {
                        return false; // ì œëª© ë ˆë²¨ì„ ê±´ë„ˆë›°ë©´ ì•ˆë¨
                    }
                    previousLevel = level;
                }
                return true;
            }

            checkAltAttributes() {
                const images = document.querySelectorAll('img');
                for (let img of images) {
                    if (!img.hasAttribute('alt')) return false;
                }
                return true;
            }

            addTestResult(container, name, details, status) {
                const testItem = document.createElement('div');
                testItem.className = 'test-item';
                
                testItem.innerHTML = `
                    <div>
                        <strong>${name}</strong><br>
                        <small style="color: var(--text-secondary);">${details}</small>
                    </div>
                    <div class="test-result ${status}">
                        ${status === 'pass' ? 'í†µê³¼' : status === 'fail' ? 'ì‹¤íŒ¨' : 'ê²½ê³ '}
                    </div>
                `;
                
                container.appendChild(testItem);
            }

            updateTestCount(status, count = 1) {
                this.testResults[status] += count;
                this.testResults.total += count;
            }

            updateSummary() {
                document.getElementById('passCount').textContent = this.testResults.pass;
                document.getElementById('warningCount').textContent = this.testResults.warning;
                document.getElementById('failCount').textContent = this.testResults.fail;
                
                const score = Math.round((this.testResults.pass / this.testResults.total) * 100);
                document.getElementById('totalScore').textContent = score + '%';
                
                document.getElementById('testSummary').style.display = 'grid';
            }

            logMessage(message) {
                this.log.push(message);
                document.getElementById('testLog').textContent = this.log.join('\n');
                
                // ë¡œê·¸ ì˜ì—­ì„ ë§¨ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤
                const logElement = document.getElementById('testLog');
                logElement.scrollTop = logElement.scrollHeight;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ í›„ í…ŒìŠ¤í„° ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            new AccessibilityTester();
        });
    </script>
</body>
</html>