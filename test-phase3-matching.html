<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>üéØ Phase 3 Îß§Ïπ≠ ÏãúÏä§ÌÖú Ïã§Ï†ú ÌÖåÏä§Ìä∏ v2.3 - Í∏ÄÏûêÏÉâ Í∞úÏÑ† (2025-07-10 19:15)</title>
    <style>
      body {
        font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      }

      .header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid #f0f0f0;
      }

      .title {
        font-size: 2.5rem;
        margin: 0;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
      }

      .subtitle {
        font-size: 1.2rem;
        color: #666;
        margin: 0.5rem 0;
      }

      .test-section {
        background: #f8f9fa;
        padding: 1.5rem;
        margin: 1.5rem 0;
        border-radius: 15px;
        border-left: 5px solid #667eea;
      }

      .test-section h3 {
        margin-top: 0;
        color: #333;
        font-size: 1.3rem;
      }

      button {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        cursor: pointer;
        margin: 0.5rem;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      button:disabled {
        background: #6c757d;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .result {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin-top: 1rem;
        border-left: 4px solid #667eea;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .success {
        border-left-color: #10b981;
        background: #f0fdf4;
      }

      .error {
        border-left-color: #ef4444;
        background: #fef2f2;
      }

      .score-display {
        font-size: 3rem;
        font-weight: 700;
        text-align: center;
        margin: 1rem 0;
        background: linear-gradient(135deg, #10b981, #059669);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .score-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin: 1rem 0;
      }

      .score-item {
        background: white;
        padding: 1rem;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .score-value {
        font-size: 1.5rem;
        font-weight: 600;
        color: #667eea;
      }

      .score-label {
        font-size: 0.9rem;
        color: #666;
        margin-top: 0.5rem;
      }

      .matching-reasons {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 10px;
        margin: 1rem 0;
      }

      .reason-item {
        background: white;
        padding: 1rem;
        margin: 0.5rem 0;
        border-radius: 8px;
        border-left: 3px solid #667eea;
      }

      .reason-title {
        font-weight: 600;
        color: #333;
        margin-bottom: 0.5rem;
      }

      .reason-description {
        color: #666;
        font-size: 0.95rem;
      }

      .importance-badge {
        background: #667eea;
        color: white;
        padding: 0.2rem 0.5rem;
        border-radius: 5px;
        font-size: 0.8rem;
        font-weight: 600;
        float: right;
      }

      .log {
        background: #1f2937;
        color: #f9fafb;
        padding: 1rem;
        border-radius: 10px;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.9rem;
        max-height: 400px;
        overflow-y: auto;
        margin-top: 1rem;
      }

      .performance-stats {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 1rem;
        border-radius: 10px;
        margin: 1rem 0;
      }

      .performance-item {
        display: inline-block;
        margin: 0 1rem;
      }

      .status {
        font-weight: 600;
        margin-bottom: 1rem;
        padding: 1rem;
        background: #e3f2fd;
        border-radius: 10px;
        text-align: center;
      }

      /* ========== Î°úÎî© ÏÉÅÌÉú Í∞úÏÑ† Ïä§ÌÉÄÏùº ========== */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 9998;
        display: none;
      }

      .loading-container {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 600px;
        padding: 2rem;
        background: #ffffff !important;
        border-radius: 15px;
        border: 3px solid #667eea;
        display: none;
        z-index: 9999;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      }

      .loading-header {
        text-align: center;
        margin-bottom: 1.5rem;
      }

      .loading-title {
        font-size: 1.5rem;
        color: #1f2937;
        margin-bottom: 0.5rem;
        font-weight: 700;
      }

      .loading-subtitle {
        color: #374151;
        font-size: 1rem;
        font-weight: 500;
      }

      /* ========== 5Îã®Í≥Ñ ÏßÑÌñâ ÏãúÍ∞ÅÌôî ========== */
      .stage-progress-container {
        margin: 2rem 0;
        padding: 1.5rem;
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        border-radius: 15px;
        border: 3px solid #667eea;
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
      }

      .current-stage {
        text-align: center;
        margin-bottom: 1.5rem;
        padding: 1rem;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        animation: stagePulse 2s infinite;
        border: 2px solid #fff;
      }

      @keyframes stagePulse {
        0% {
          transform: scale(1);
          box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        50% {
          transform: scale(1.02);
          box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
      }

      .stage-number {
        font-size: 1.5rem;
        font-weight: 700;
        margin-right: 0.5rem;
      }

      .stage-icon {
        font-size: 1.8rem;
        margin: 0 0.5rem;
        animation: iconBounce 1.5s infinite;
      }

      @keyframes iconBounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-5px);
        }
      }

      .stage-text {
        font-size: 1.1rem;
        font-weight: 600;
      }

      .stages-indicator {
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 1rem 0;
      }

      .stage-dot {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0.5rem;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        background: #ffffff;
        border: 3px solid #dee2e6;
        transition: all 0.3s ease;
        position: relative;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .stage-dot.active {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-color: #667eea;
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }

      .stage-dot.completed {
        background: linear-gradient(135deg, #10b981, #059669);
        border-color: #10b981;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
      }

      .stage-emoji {
        font-size: 1.2rem;
        margin-bottom: 0.2rem;
      }

      .stage-label {
        font-size: 0.7rem;
        font-weight: 600;
        color: #333;
        text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
      }

      .stage-dot.active .stage-label,
      .stage-dot.completed .stage-label {
        color: white;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .stage-connector {
        width: 40px;
        height: 4px;
        background: #dee2e6;
        border-radius: 2px;
        transition: all 0.5s ease;
      }

      .stage-connector.completed {
        background: linear-gradient(90deg, #10b981, #059669);
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
      }

      .progress-container {
        width: 100%;
        height: 12px;
        background-color: #e9ecef;
        border-radius: 6px;
        overflow: hidden;
        margin: 1.5rem 0;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
        background-size: 200% 100%;
        border-radius: 6px;
        transition: width 0.5s ease;
        animation: shimmer 2s infinite linear;
      }

      .progress-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 0.9rem;
        font-weight: 700;
        color: #1a202c;
        text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.9);
        z-index: 10;
      }

      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }

      .loading-steps {
        margin: 1.5rem 0;
      }

      .loading-step {
        display: flex;
        align-items: center;
        margin: 0.8rem 0;
        padding: 0.5rem;
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      .loading-step.active {
        background: rgba(102, 126, 234, 0.15);
        border-left: 4px solid #667eea;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        animation: pulse 2s infinite;
      }

      .loading-step.completed {
        background: rgba(16, 185, 129, 0.1);
        border-left: 4px solid #10b981;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2);
        animation: completedGlow 0.5s ease-out;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes completedGlow {
        0% {
          box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2);
        }
        50% {
          box-shadow: 0 4px 16px rgba(16, 185, 129, 0.4);
        }
        100% {
          box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2);
        }
      }

      .step-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-weight: bold;
        font-size: 0.8rem;
      }

      .step-icon.pending {
        background: #e9ecef;
        color: #6c757d;
      }

      .step-icon.active {
        background: #667eea;
        color: white;
        animation: iconPulse 1.5s infinite;
        box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
      }

      .step-icon.completed {
        background: #10b981;
        color: white;
        animation: iconSuccess 0.6s ease-out;
        box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
      }

      @keyframes iconPulse {
        0% {
          transform: scale(1);
          box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }
        50% {
          transform: scale(1.1);
          box-shadow: 0 0 20px rgba(102, 126, 234, 0.7);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }
      }

      @keyframes iconSuccess {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.3);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      .step-text {
        flex: 1;
      }

      .step-title {
        font-weight: 700 !important;
        color: #111827 !important;
      }

      .step-description {
        font-size: 0.9rem !important;
        color: #1f2937 !important;
        font-weight: 600 !important;
      }

      .step-time {
        font-size: 0.8rem !important;
        color: #374151 !important;
        margin-left: auto;
        font-weight: 600 !important;
      }

      .processing-animation {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 1rem 0;
      }

      .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #667eea;
        margin: 0 4px;
        animation: bounce 1.4s infinite ease-in-out both;
      }

      .dot:nth-child(1) {
        animation-delay: -0.32s;
      }
      .dot:nth-child(2) {
        animation-delay: -0.16s;
      }
      .dot:nth-child(3) {
        animation-delay: 0s;
      }

      @keyframes bounce {
        0%,
        80%,
        100% {
          transform: scale(0);
        }
        40% {
          transform: scale(1);
        }
      }

      .estimated-time {
        text-align: center;
        color: #666;
        font-size: 0.9rem;
        margin-top: 1rem;
        font-style: italic;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in {
        animation: fadeIn 0.5s ease-out;
      }

      /* ========== Í∞úÏù∏Ìôî ÏãúÏä§ÌÖú Ïä§ÌÉÄÏùº ========== */
      .personalization-results {
        margin-top: 1rem;
      }

      .score-comparison {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin: 1rem 0;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
      }

      .score-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 0.8rem 0;
        padding: 0.5rem;
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      .score-item:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(5px);
      }

      .score-item.highlight {
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        font-weight: 600;
        transform: scale(1.02);
      }

      .score-item.final {
        background: rgba(255, 255, 255, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.5);
        font-weight: 700;
        font-size: 1.1rem;
        transform: scale(1.05);
      }

      .score-label {
        font-size: 0.95rem;
      }

      .score-value {
        font-size: 1.2rem;
        font-weight: 700;
        color: #ffd700;
      }

      .personalization-info {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 8px;
        margin: 1rem 0;
        border-left: 4px solid #667eea;
      }

      .personalization-info p {
        margin: 0.5rem 0;
        font-size: 0.95rem;
      }

      .preference-patterns {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin: 1rem 0;
      }

      /* üéØ 4060ÏÑ∏ÎåÄ Î™®Î∞îÏùº ÏµúÏ†ÅÌôî - ÌÑ∞Ïπò Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Ïö∞ÏÑ† */
      @media (max-width: 768px) {
        /* Í∏∞Î≥∏ Î†àÏù¥ÏïÑÏõÉ */
        body {
          padding: 1rem;
          font-size: 18px; /* 4060ÏÑ∏ÎåÄ Í∞ÄÎèÖÏÑ± Ìñ•ÏÉÅ */
        }

        .container {
          padding: 1.5rem;
          border-radius: 15px;
        }

        /* Ï†úÎ™© Î∞è ÌÖçÏä§Ìä∏ ÏµúÏ†ÅÌôî */
        .title {
          font-size: 2rem;
          line-height: 1.3;
        }

        .subtitle {
          font-size: 1.1rem;
          line-height: 1.4;
        }

        /* Î≤ÑÌäº ÌÑ∞Ïπò ÏµúÏ†ÅÌôî - 44px+ */
        button {
          padding: 0.9rem 1.2rem;
          font-size: 1.1rem;
          min-height: 44px;
          min-width: 44px;
          margin: 0.75rem 0.5rem;
          border-radius: 8px;
        }

        /* ÌÖåÏä§Ìä∏ ÏÑπÏÖò ÏµúÏ†ÅÌôî */
        .test-section {
          padding: 1.2rem;
          margin: 1rem 0;
          border-radius: 12px;
        }

        .test-section h3 {
          font-size: 1.2rem;
          margin-bottom: 0.8rem;
        }

        .test-section p {
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Í∑∏Î¶¨Îìú Î†àÏù¥ÏïÑÏõÉ */
        .preference-patterns {
          grid-template-columns: 1fr;
          gap: 0.8rem;
        }

        /* Î°úÎî© UI Î™®Î∞îÏùº ÏµúÏ†ÅÌôî */
        .loading-container {
          padding: 1rem;
          max-width: 95%;
        }

        .loading-title {
          font-size: 1.3rem;
        }

        .loading-subtitle {
          font-size: 1rem;
        }

        .current-stage {
          padding: 0.8rem;
          border-radius: 8px;
        }

        .stage-number {
          font-size: 1.2rem;
          min-width: 32px;
          min-height: 32px;
        }

        .stage-text {
          font-size: 0.95rem;
        }

        /* 5Îã®Í≥Ñ ÏßÑÌñâ ÌëúÏãú ÏµúÏ†ÅÌôî */
        .stages-indicator {
          flex-direction: column;
          gap: 0.5rem;
          padding: 1rem 0;
        }

        .stage-dot {
          width: 100%;
          height: 44px;
          border-radius: 8px;
          flex-direction: row;
          justify-content: flex-start;
          padding: 0 1rem;
          gap: 0.8rem;
        }

        .stage-connector {
          display: none; /* ÏÑ∏Î°ú Î†àÏù¥ÏïÑÏõÉÏóêÏÑúÎäî Ïó∞Í≤∞ÏÑ† Ï†úÍ±∞ */
        }

        .stage-emoji {
          font-size: 1.2rem;
        }

        .stage-label {
          font-size: 1rem;
          font-weight: 600;
        }

        /* Í≤∞Í≥º ÌëúÏãú ÏµúÏ†ÅÌôî */
        .result {
          padding: 1.2rem;
          border-radius: 10px;
          margin-top: 0.8rem;
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Ï†êÏàò ÌëúÏãú ÏµúÏ†ÅÌôî */
        .score-item {
          padding: 0.8rem;
          border-radius: 8px;
          margin: 0.5rem 0;
          min-height: 44px;
        }

        .score-label {
          font-size: 1rem;
        }

        .score-value {
          font-size: 1.3rem;
        }

        /* Ìå®ÌÑ¥ ÏÑπÏÖò ÏµúÏ†ÅÌôî */
        .pattern-section {
          padding: 1rem;
          border-radius: 10px;
          margin: 0.5rem 0;
        }

        .pattern-item {
          padding: 0.8rem;
          margin: 0.5rem 0;
          border-radius: 8px;
          font-size: 0.95rem;
          min-height: 40px;
        }

        /* Ï∂îÏ≤ú ÏÇ¨Ìï≠ ÏµúÏ†ÅÌôî */
        .recommendations {
          padding: 1.2rem;
          border-radius: 10px;
          margin: 1rem 0;
        }

        .recommendation-item {
          padding: 0.8rem;
          margin: 0.5rem 0;
          border-radius: 6px;
          font-size: 1rem;
          line-height: 1.4;
          min-height: 40px;
        }

        /* Í∞úÏù∏Ìôî Ï†ïÎ≥¥ ÏµúÏ†ÅÌôî */
        .personalization-info {
          padding: 1.2rem;
          border-radius: 10px;
          margin: 1rem 0;
        }

        .personalization-info p {
          font-size: 1rem;
          line-height: 1.5;
          margin: 0.8rem 0;
        }

        /* ÏÉÅÌÉú ÌëúÏãú ÏµúÏ†ÅÌôî */
        .status {
          padding: 1rem;
          font-size: 1.1rem;
          border-radius: 10px;
          margin: 1rem 0;
        }

        /* ÌïòÏù¥ÎùºÏù¥Ìä∏ ÏÑπÏÖò ÏµúÏ†ÅÌôî */
        .improvement-highlight {
          padding: 1.5rem;
          border-radius: 12px;
          margin: 1rem 0;
          text-align: center;
        }

        .improvement-highlight h6 {
          font-size: 1.3rem;
          margin-bottom: 1rem;
        }

        .improvement-highlight p {
          font-size: 1rem;
          line-height: 1.5;
          margin: 0.8rem 0;
        }
      }

      .pattern-section {
        background: #f0f8ff;
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid #e0e7ff;
      }

      .pattern-section h6 {
        margin: 0 0 0.5rem 0;
        color: #667eea;
        font-size: 0.9rem;
        font-weight: 600;
      }

      .pattern-item {
        background: white;
        padding: 0.5rem;
        margin: 0.3rem 0;
        border-radius: 6px;
        border-left: 3px solid #667eea;
        font-size: 0.85rem;
        transition: all 0.3s ease;
      }

      .pattern-item:hover {
        transform: translateX(3px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .recommendations {
        background: #f0fdf4;
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid #bbf7d0;
        margin: 1rem 0;
      }

      .recommendation-item {
        color: #166534;
        margin: 0.5rem 0;
        font-size: 0.9rem;
        padding: 0.3rem;
        border-radius: 4px;
        transition: all 0.3s ease;
      }

      .recommendation-item:hover {
        background: #dcfce7;
        transform: translateX(3px);
      }

      .improvement-highlight {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin: 1rem 0;
        text-align: center;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
      }

      .improvement-highlight h6 {
        margin: 0 0 1rem 0;
        font-size: 1.2rem;
        color: #ffd700;
      }

      .improvement-highlight p {
        margin: 0.5rem 0;
        font-size: 0.95rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1 class="title">üéØ Phase 3 Îß§Ïπ≠ ÏãúÏä§ÌÖú v3.0 - Í∏ÄÏûêÏÉâ Í∞úÏÑ† ÌÖåÏä§Ìä∏</h1>
        <p class="subtitle">Ìè¨Ìä∏ ÏàòÏ†ï + 5Îã®Í≥Ñ ÏãúÍ∞ÅÌôî - CHARM_INYEON</p>
        <div
          style="
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 0.75rem;
            border-radius: 8px;
            margin: 1rem 0;
            color: #856404;
          "
        >
          ‚ö° <strong>Ï∫êÏãú ÏÉàÎ°úÍ≥†Ïπ®:</strong> Ctrl+F5 (Windows) ÎòêÎäî Cmd+Shift+R (Mac)ÏúºÎ°ú Í∞ïÏ†ú
          ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏÑ∏Ïöî!
        </div>
      </div>

      <div class="status" id="status">
        üöÄ Phase 3 Îß§Ïπ≠ ÏãúÏä§ÌÖú Ï§ÄÎπÑ ÏôÑÎ£å! Ïã§Ï†ú ÌÖåÏä§Ìä∏Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî.
      </div>

      <!-- ========== Î°úÎî© ÏÉÅÌÉú Í∞úÏÑ† Ïª®ÌÖåÏù¥ÎÑà ========== -->
      <div class="loading-overlay" id="loadingOverlay"></div>
      <div class="loading-container" id="loadingContainer">
        <div class="loading-header">
          <div class="loading-title" id="loadingTitle">Îß§Ïπ≠ Î∂ÑÏÑù ÏßÑÌñâ Ï§ë</div>
          <div class="loading-subtitle" id="loadingSubtitle">Ïû†ÏãúÎßå Í∏∞Îã§Î†§Ï£ºÏÑ∏Ïöî...</div>
        </div>

        <!-- 5Îã®Í≥Ñ ÏßÑÌñâ Î∞î -->
        <div class="stage-progress-container">
          <div class="current-stage" id="currentStage">
            <span class="stage-number" id="stageNumber">1</span>
            <span class="stage-icon" id="stageIcon">üîÑ</span>
            <span class="stage-text" id="stageText">Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî Ï§ë...</span>
          </div>

          <div class="stages-indicator">
            <div class="stage-dot active" id="stage-dot-0" data-stage="0">
              <span class="stage-emoji">üîÑ</span>
              <span class="stage-label">Ï¥àÍ∏∞Ìôî</span>
            </div>
            <div class="stage-connector" id="connector-0"></div>

            <div class="stage-dot" id="stage-dot-1" data-stage="1">
              <span class="stage-emoji">üìö</span>
              <span class="stage-label">ÌûàÏä§ÌÜ†Î¶¨</span>
            </div>
            <div class="stage-connector" id="connector-1"></div>

            <div class="stage-dot" id="stage-dot-2" data-stage="2">
              <span class="stage-emoji">üß†</span>
              <span class="stage-label">ÌïôÏäµ</span>
            </div>
            <div class="stage-connector" id="connector-2"></div>

            <div class="stage-dot" id="stage-dot-3" data-stage="3">
              <span class="stage-emoji">üíñ</span>
              <span class="stage-label">Îß§Ïπ≠</span>
            </div>
            <div class="stage-connector" id="connector-3"></div>

            <div class="stage-dot" id="stage-dot-4" data-stage="4">
              <span class="stage-emoji">‚ú®</span>
              <span class="stage-label">Ïù∏ÏÇ¨Ïù¥Ìä∏</span>
            </div>
          </div>
        </div>

        <div class="progress-container">
          <div class="progress-bar" id="progressBar" style="width: 0%"></div>
          <div class="progress-text" id="progressText">0%</div>
        </div>

        <div class="loading-steps" id="loadingSteps">
          <!-- Îã®Í≥ÑÎ≥Ñ ÏßÑÌñâ ÏÉÅÌô©Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
        </div>

        <div class="processing-animation">
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>

        <div class="estimated-time" id="estimatedTime">ÏòàÏÉÅ ÏôÑÎ£å ÏãúÍ∞Ñ: ÏïΩ 2-3Ï¥à</div>
      </div>

      <div class="test-section">
        <h3>üîç 1. ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏</h3>
        <p style="color: #dc2626 !important; font-weight: 600 !important">
          ‚úÖ Í∏ÄÏûêÏÉâ ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ! Ï†ïÏ†Å ÌååÏùº ÏÑúÎ≤Ñ (localhost:3001) Ïó∞Í≤∞ ÏÉÅÌÉúÎ•º ÌôïÏù∏Ìï©ÎãàÎã§.
        </p>
        <button onclick="testServerConnection()">ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÌÖåÏä§Ìä∏</button>
        <div id="serverResult" class="result" style="display: none"></div>
      </div>

      <div class="test-section">
        <h3>‚ö° 2. Phase 3 Îß§Ïπ≠ ÏóîÏßÑ ÌÖåÏä§Ìä∏</h3>
        <p>Ïã§Ï†ú Phase 3 Îß§Ïπ≠ ÏïåÍ≥†Î¶¨Ï¶òÏùÑ ÌÖåÏä§Ìä∏Ìï©ÎãàÎã§. (104Ï†ê Îß§Ïπ≠ ÏãúÎÇòÎ¶¨Ïò§)</p>
        <button onclick="testPhase3Matching()">104Ï†ê Îß§Ïπ≠ ÌÖåÏä§Ìä∏</button>
        <button onclick="testMultipleMatches()">Îã§Ï§ë Îß§Ïπ≠ ÌÖåÏä§Ìä∏ (10Ìöå)</button>
        <div id="matchingResult" class="result" style="display: none"></div>
      </div>

      <div class="test-section">
        <h3>üìä 3. Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÏóîÏßÑ ÌÖåÏä§Ìä∏</h3>
        <p>4060ÏÑ∏ÎåÄ ÌäπÌôî Í∞ÄÏπòÍ¥Ä 5Ï∞®Ïõê Î∂ÑÏÑùÏùÑ ÌÖåÏä§Ìä∏Ìï©ÎãàÎã§.</p>
        <button onclick="testValuesAnalysis()">5Ï∞®Ïõê Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù</button>
        <div id="valuesResult" class="result" style="display: none"></div>
      </div>

      <div class="test-section">
        <h3>üé® 4. ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± ÌÖåÏä§Ìä∏</h3>
        <p>Îß§Ïπ≠ Í≤∞Í≥º ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±ÏùÑ ÌÖåÏä§Ìä∏Ìï©ÎãàÎã§.</p>
        <button onclick="testVisualization()">ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±</button>
        <div id="visualResult" class="result" style="display: none"></div>
      </div>

      <div class="test-section">
        <h3>üöÄ 5. ÏÑ±Îä• Ï¢ÖÌï© ÌÖåÏä§Ìä∏</h3>
        <p>Phase 3 ÏãúÏä§ÌÖúÏùò Ï†ÑÏ≤¥Ï†ÅÏù∏ ÏÑ±Îä•ÏùÑ ÌÖåÏä§Ìä∏Ìï©ÎãàÎã§.</p>
        <button onclick="runPerformanceTest()">ÏÑ±Îä• ÌÖåÏä§Ìä∏ (0.5ms Î™©Ìëú)</button>
        <div id="performanceResult" class="result" style="display: none"></div>
      </div>

      <div
        class="test-section"
        style="
          background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
          color: white;
          border: 2px solid #ff6b6b;
        "
      >
        <h3>üéØ 6. Í∞úÏù∏Ìôî Îß§Ïπ≠ ÏãúÏä§ÌÖú (ÏôÑÏ†ÑÏ≤¥++ 2Îã®Í≥Ñ)</h3>
        <p style="color: #fff">
          4060ÏÑ∏ÎåÄ ÌäπÌôî Í∞úÏù∏ ÎßûÏ∂§Ìòï Îß§Ïπ≠ Î∂ÑÏÑù ÏãúÏä§ÌÖúÏùÑ ÌÖåÏä§Ìä∏Ìï©ÎãàÎã§. Í≥ºÍ±∞ Îß§Ïπ≠ Ìå®ÌÑ¥ ÌïôÏäµÍ≥º Ï†ÅÏùëÌòï
          ÏïåÍ≥†Î¶¨Ï¶òÏúºÎ°ú ÎçîÏö± Ï†ïÌôïÌïú Îß§Ïπ≠ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.
        </p>
        <button
          onclick="testPersonalizedMatching()"
          style="background: #fff; color: #ff6b6b; border: 2px solid #fff; font-weight: bold"
        >
          üéØ Í∞úÏù∏Ìôî Îß§Ïπ≠ ÌÖåÏä§Ìä∏
        </button>
        <div id="personalizedResult" class="result" style="display: none"></div>
      </div>

      <div class="log" id="log">Î°úÍ∑∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§...</div>
    </div>

    <script>
      let testCount = 0;

      function log(message) {
        const logElement = document.getElementById('log');
        const timestamp = new Date().toLocaleTimeString();
        logElement.innerHTML += `[${timestamp}] ${message}\n`;
        logElement.scrollTop = logElement.scrollHeight;
      }

      function updateStatus(message) {
        document.getElementById('status').innerHTML = message;
      }

      function showResult(elementId, content, isSuccess = true) {
        const element = document.getElementById(elementId);
        element.innerHTML = content;
        element.className = `result ${isSuccess ? 'success' : 'error'} fade-in`;
        element.style.display = 'block';
      }

      // ========== Î°úÎî© ÏÉÅÌÉú Í∞úÏÑ† ÏãúÏä§ÌÖú ==========

      class LoadingManager {
        constructor() {
          this.overlay = document.getElementById('loadingOverlay');
          this.container = document.getElementById('loadingContainer');
          this.title = document.getElementById('loadingTitle');
          this.subtitle = document.getElementById('loadingSubtitle');
          this.progressBar = document.getElementById('progressBar');
          this.progressText = document.getElementById('progressText');
          this.stepsContainer = document.getElementById('loadingSteps');
          this.estimatedTime = document.getElementById('estimatedTime');
          this.stageNumber = document.getElementById('stageNumber');
          this.stageIcon = document.getElementById('stageIcon');
          this.stageText = document.getElementById('stageText');
          this.currentStep = 0;
          this.totalSteps = 0;
          this.startTime = null;
          this.stageInfo = [
            { icon: 'üîÑ', text: 'Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî Ï§ë...', color: '#667eea' },
            { icon: 'üìö', text: 'ÌûàÏä§ÌÜ†Î¶¨ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Ï§ë...', color: '#f59e0b' },
            { icon: 'üß†', text: 'Ï†ÅÏùëÌòï ÌïôÏäµ ÏßÑÌñâ Ï§ë...', color: '#8b5cf6' },
            { icon: 'üíñ', text: 'Í∞úÏù∏Ìôî Îß§Ïπ≠ Î∂ÑÏÑù Ï§ë...', color: '#ef4444' },
            { icon: '‚ú®', text: 'Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± Ï§ë...', color: '#10b981' },
          ];
        }

        show(title, subtitle, steps, estimatedTime = '2-3Ï¥à') {
          this.title.textContent = title;
          this.subtitle.textContent = subtitle;
          this.estimatedTime.textContent = `ÏòàÏÉÅ ÏôÑÎ£å ÏãúÍ∞Ñ: ÏïΩ ${estimatedTime}`;
          this.setupSteps(steps);

          // Ïò§Î≤ÑÎ†àÏù¥ÏôÄ Ïª®ÌÖåÏù¥ÎÑà Ìï®Íªò ÌëúÏãú
          if (this.overlay) this.overlay.style.display = 'block';
          this.container.style.display = 'block';
          this.container.classList.add('fade-in');
          this.startTime = Date.now();

          // Ï≤´ Î≤àÏß∏ Îã®Í≥Ñ ÏãúÍ∞ÅÌôî Ï¥àÍ∏∞Ìôî
          this.updateStageVisual(0);

          log(`üîÑ ${title} ÏãúÏûë`);
        }

        hide() {
          if (this.overlay) this.overlay.style.display = 'none';
          this.container.style.display = 'none';
          this.reset();
        }

        setupSteps(steps) {
          this.totalSteps = steps.length;
          this.currentStep = 0;
          this.stepsContainer.innerHTML = '';

          steps.forEach((step, index) => {
            const stepElement = document.createElement('div');
            stepElement.className = 'loading-step';
            stepElement.id = `step-${index}`;

            stepElement.innerHTML = `
                        <div class="step-icon pending" id="icon-${index}">${index + 1}</div>
                        <div class="step-text">
                            <div class="step-title" style="color: #000000 !important; font-weight: 800 !important; font-size: 1rem !important;">${
                              step.title
                            }</div>
                            <div class="step-description" style="color: #dc2626 !important; font-weight: 700 !important; font-size: 0.95rem !important;">${
                              step.description
                            }</div>
                            <div class="step-detail" id="detail-${index}" style="display: none; color: #7c3aed !important; font-size: 0.9rem; margin-top: 0.3rem; font-style: italic; font-weight: 600 !important;">${
              step.detail || ''
            }</div>
                        </div>
                        <div class="step-time" id="time-${index}" style="color: #059669 !important; font-weight: 700 !important; font-size: 0.85rem !important;">ÎåÄÍ∏∞ Ï§ë</div>
                    `;

            this.stepsContainer.appendChild(stepElement);
          });
        }

        nextStep(customMessage = null) {
          if (this.currentStep > 0) {
            // Ïù¥Ï†Ñ Îã®Í≥Ñ ÏôÑÎ£å Ï≤òÎ¶¨
            const prevStep = document.getElementById(`step-${this.currentStep - 1}`);
            const prevIcon = document.getElementById(`icon-${this.currentStep - 1}`);
            const prevTime = document.getElementById(`time-${this.currentStep - 1}`);
            const prevDetail = document.getElementById(`detail-${this.currentStep - 1}`);

            prevStep.className = 'loading-step completed';
            prevIcon.className = 'step-icon completed';
            prevIcon.innerHTML = '‚úì';
            prevTime.textContent = 'ÏôÑÎ£å';
            if (prevDetail) prevDetail.style.display = 'none';

            // ÌÉÄÏù¥Î®∏ Ï†ïÎ¶¨
            this.stopStepTimer();
          }

          if (this.currentStep < this.totalSteps) {
            // ÌòÑÏû¨ Îã®Í≥Ñ ÌôúÏÑ±Ìôî
            const currentStep = document.getElementById(`step-${this.currentStep}`);
            const currentIcon = document.getElementById(`icon-${this.currentStep}`);
            const currentTime = document.getElementById(`time-${this.currentStep}`);
            const currentDetail = document.getElementById(`detail-${this.currentStep}`);

            currentStep.className = 'loading-step active';
            currentIcon.className = 'step-icon active';
            currentTime.textContent = 'ÏßÑÌñâ Ï§ë...';

            // ÏÉÅÏÑ∏ ÏÑ§Î™Ö ÌëúÏãú
            if (currentDetail) {
              currentDetail.style.display = 'block';
              currentDetail.style.animation = 'fadeIn 0.5s ease-out';
            }

            // ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏ (20%, 40%, 60%, 80%, 100%)
            const progress = ((this.currentStep + 1) / this.totalSteps) * 100;
            this.updateProgress(progress);

            // 5Îã®Í≥Ñ ÏãúÍ∞ÅÌôî ÏóÖÎç∞Ïù¥Ìä∏
            this.updateStageVisual(this.currentStep);

            // Í∞Å Îã®Í≥ÑÎ≥Ñ ÌÉÄÏù¥Î®∏ ÏãúÏûë
            this.startStepTimer(this.currentStep);

            // ÏÇ¨Ïö©Ïûê Ï†ïÏùò Î©îÏãúÏßÄÍ∞Ä ÏûàÏúºÎ©¥ Î°úÍ∑∏Ïóê Ï∂úÎ†•
            if (customMessage) {
              log(`üìã ${customMessage}`);
            }

            this.currentStep++;
          }
        }

        complete(message = 'Î∂ÑÏÑùÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!') {
          // ÎßàÏßÄÎßâ Îã®Í≥Ñ ÏôÑÎ£å
          if (this.currentStep > 0) {
            const lastStep = document.getElementById(`step-${this.currentStep - 1}`);
            const lastIcon = document.getElementById(`icon-${this.currentStep - 1}`);
            const lastTime = document.getElementById(`time-${this.currentStep - 1}`);

            lastStep.className = 'loading-step completed';
            lastIcon.className = 'step-icon completed';
            lastIcon.textContent = '‚úì';
            lastTime.textContent = 'ÏôÑÎ£å';
          }

          this.updateProgress(100);
          this.subtitle.textContent = message;

          // Î™®Îì† Îã®Í≥ÑÎ•º ÏôÑÎ£å ÏÉÅÌÉúÎ°ú ÌëúÏãú
          for (let i = 0; i < 5; i++) {
            const dot = document.getElementById(`stage-dot-${i}`);
            const connector = document.getElementById(`connector-${i}`);
            dot.className = 'stage-dot completed';
            if (connector) connector.className = 'stage-connector completed';
          }

          // ÏµúÏ¢Ö Îã®Í≥Ñ ÌëúÏãú
          this.stageNumber.textContent = 'ÏôÑÎ£å';
          this.stageIcon.textContent = 'üéä';
          this.stageText.textContent = 'Í∞úÏù∏Ìôî Îß§Ïπ≠ Î∂ÑÏÑù ÏôÑÎ£å!';
          const currentStage = document.getElementById('currentStage');
          currentStage.style.background = 'linear-gradient(135deg, #10b981, #059669)';

          const totalTime = Date.now() - this.startTime;
          log(`‚úÖ ÏôÑÎ£å! Ï¥ù Ï≤òÎ¶¨ ÏãúÍ∞Ñ: ${totalTime}ms`);

          // 1Ï¥à ÌõÑ Î°úÎî©Ï∞Ω Ïà®ÍπÄ
          setTimeout(() => this.hide(), 1000);
        }

        updateProgress(percentage) {
          this.progressBar.style.width = `${percentage}%`;
          if (this.progressText) {
            this.progressText.textContent = `${Math.round(percentage)}%`;
          }
        }

        updateStageVisual(stepIndex) {
          // ÌòÑÏû¨ Îã®Í≥Ñ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
          if (stepIndex < this.stageInfo.length) {
            const stage = this.stageInfo[stepIndex];
            this.stageNumber.textContent = stepIndex + 1;
            this.stageIcon.textContent = stage.icon;
            this.stageText.textContent = stage.text;

            // ÌòÑÏû¨ Îã®Í≥Ñ ÏÉâÏÉÅ Î≥ÄÍ≤Ω
            const currentStage = document.getElementById('currentStage');
            currentStage.style.background = `linear-gradient(135deg, ${
              stage.color
            }, ${this.adjustColor(stage.color, -20)})`;
          }

          // Îã®Í≥Ñ ÎèÑÌä∏ ÏóÖÎç∞Ïù¥Ìä∏
          for (let i = 0; i < 5; i++) {
            const dot = document.getElementById(`stage-dot-${i}`);
            const connector = document.getElementById(`connector-${i}`);

            if (i < stepIndex) {
              // ÏôÑÎ£åÎêú Îã®Í≥Ñ
              dot.className = 'stage-dot completed';
              if (connector) connector.className = 'stage-connector completed';
            } else if (i === stepIndex) {
              // ÌòÑÏû¨ Îã®Í≥Ñ
              dot.className = 'stage-dot active';
            } else {
              // ÎåÄÍ∏∞ Ï§ëÏù∏ Îã®Í≥Ñ
              dot.className = 'stage-dot';
              if (connector) connector.className = 'stage-connector';
            }
          }
        }

        adjustColor(color, amount) {
          const usePound = color[0] === '#';
          const col = usePound ? color.slice(1) : color;
          const num = parseInt(col, 16);
          let r = (num >> 16) + amount;
          let g = ((num >> 8) & 0x00ff) + amount;
          let b = (num & 0x0000ff) + amount;
          r = r > 255 ? 255 : r < 0 ? 0 : r;
          g = g > 255 ? 255 : g < 0 ? 0 : g;
          b = b > 255 ? 255 : b < 0 ? 0 : b;
          return (usePound ? '#' : '') + ((r << 16) | (g << 8) | b).toString(16).padStart(6, '0');
        }

        reset() {
          this.currentStep = 0;
          this.totalSteps = 0;
          this.updateProgress(0);
          if (this.stepTimer) {
            clearInterval(this.stepTimer);
            this.stepTimer = null;
          }
        }

        startStepTimer(stepIndex) {
          if (this.stepTimer) {
            clearInterval(this.stepTimer);
          }

          let seconds = 0;
          const timeElement = document.getElementById(`time-${stepIndex}`);

          this.stepTimer = setInterval(() => {
            seconds++;
            if (timeElement) {
              timeElement.textContent = `ÏßÑÌñâ Ï§ë... (${seconds}Ï¥à)`;
            }
          }, 1000);
        }

        stopStepTimer() {
          if (this.stepTimer) {
            clearInterval(this.stepTimer);
            this.stepTimer = null;
          }
        }

        setError(message) {
          this.subtitle.textContent = `Ïò§Î•ò: ${message}`;
          this.subtitle.style.color = '#dc3545';

          // ÌòÑÏû¨ Îã®Í≥ÑÎ•º ÏóêÎü¨ ÏÉÅÌÉúÎ°ú ÌëúÏãú
          if (this.currentStep > 0) {
            const currentStep = document.getElementById(`step-${this.currentStep - 1}`);
            const currentIcon = document.getElementById(`icon-${this.currentStep - 1}`);

            if (currentStep && currentIcon) {
              currentStep.style.borderLeftColor = '#dc3545';
              currentIcon.style.background = '#dc3545';
              currentIcon.textContent = '!';
            }
          }

          setTimeout(() => this.hide(), 3000);
        }
      }

      // Î°úÎî© Îß§ÎãàÏ†Ä Ïù∏Ïä§ÌÑ¥Ïä§ ÏÉùÏÑ±
      const loadingManager = new LoadingManager();

      // 1. ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
      async function testServerConnection() {
        log('üîç ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ ÏãúÏûë...');
        updateStatus('üîç ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ Ï§ë...');

        try {
          const response = await fetch('http://localhost:3001/simple-test.json');
          const data = await response.json();

          log('‚úÖ ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÏÑ±Í≥µ!');
          log(`üìä ÏÑúÎ≤Ñ Ï†ïÎ≥¥: ${JSON.stringify(data, null, 2)}`);

          const resultHTML = `
                    <h4>‚úÖ Ï†ïÏ†Å ÌååÏùº ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÏÑ±Í≥µ!</h4>
                    <p><strong>ÏÉÅÌÉú:</strong> ${data.status}</p>
                    <p><strong>ÏÑúÎ≤Ñ:</strong> ${data.server}</p>
                    <p><strong>Ìè¨Ìä∏:</strong> ${data.port}</p>
                    <p><strong>Î≤ÑÏ†Ñ:</strong> ${data.version}</p>
                    <p><strong>Î©îÏãúÏßÄ:</strong> ${data.message}</p>
                    <p><strong>ÏßÄÏõê Í∏∞Îä•:</strong> ${data.features.join(', ')}</p>
                `;

          showResult('serverResult', resultHTML, true);
          updateStatus('‚úÖ Ï†ïÏ†Å ÌååÏùº ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÏôÑÎ£å! Phase 3 Îß§Ïπ≠ ÌÖåÏä§Ìä∏ Ï§ÄÎπÑÎê®!');
        } catch (error) {
          log(`‚ùå ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`);
          showResult('serverResult', `‚ùå ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, false);
          updateStatus('‚ùå Ï†ïÏ†Å ÌååÏùº ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïã§Ìå®! localhost:3001Ïù¥ Ïã§ÌñâÏ§ëÏù∏ÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
        }
      }

      // 2. Phase 3 Îß§Ïπ≠ ÏóîÏßÑ ÌÖåÏä§Ìä∏
      async function testPhase3Matching() {
        // Î°úÎî© Îã®Í≥Ñ Ï†ïÏùò
        const steps = [
          { title: 'Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù', description: 'ÏÇ¨Ïö©Ïûê Í∞ÄÏπòÍ¥Ä Îç∞Ïù¥ÌÑ∞ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨' },
          { title: 'Í∏∞Î≥∏ Ìò∏ÌôòÏÑ± Í≥ÑÏÇ∞', description: 'ÌïµÏã¨ Í∞ÄÏπòÍ¥Ä Î∞è ÏÑ±Í≤© Ìò∏ÌôòÏÑ± Î∂ÑÏÑù' },
          { title: '4060ÏÑ∏ÎåÄ Ï°∞Ï†ï', description: 'Ï§ëÏû•ÎÖÑÏ∏µ ÌäπÏÑ± Î∞òÏòÅ Ï†êÏàò Ï°∞Ï†ï' },
          { title: 'Îß§Ïπ≠ Ïù¥Ïú† Î∂ÑÏÑù', description: 'Íµ¨Ï≤¥Ï†ÅÏù∏ Îß§Ïπ≠ Í∑ºÍ±∞ ÏÉùÏÑ±' },
          { title: 'Í¥ÄÍ≥Ñ Í∞ÄÏù¥Îìú ÏÉùÏÑ±', description: 'ÎßåÎÇ® Í∞ÄÏù¥Îìú Î∞è Î°úÎìúÎßµ ÏûëÏÑ±' },
        ];

        loadingManager.show(
          'Phase 3 Îß§Ïπ≠ Î∂ÑÏÑù',
          'Í≥†ÎèÑÌôîÎêú AI Îß§Ïπ≠ ÏïåÍ≥†Î¶¨Ï¶òÏùÑ Ïã§ÌñâÌï©ÎãàÎã§',
          steps,
          '2-3Ï¥à'
        );

        await new Promise(resolve => setTimeout(resolve, 500)); // UI ÏóÖÎç∞Ïù¥Ìä∏ ÎåÄÍ∏∞

        const startTime = performance.now();

        try {
          // Ïã§Ï†ú Îß§Ïπ≠ ÏóîÏßÑ Ìò∏Ï∂ú (test-matching-engine.jsÏôÄ ÎèôÏùºÌïú Îç∞Ïù¥ÌÑ∞)
          const testData = {
            user1: {
              userId: 'user1',
              valueCategories: {
                family: 85,
                security: 75,
                health: 80,
                relationships: 90,
                spirituality: 65,
                growth: 70,
              },
              personalityScores: {
                agreeableness: 78,
                conscientiousness: 85,
                extroversion: 65,
                openness: 71,
                emotionalStability: 80,
                optimism: 75,
                empathy: 82,
              },
              interests: [
                { category: 'reading', intensity: 8 },
                { category: 'cooking', intensity: 7 },
                { category: 'traveling', intensity: 6 },
              ],
            },
            user2: {
              userId: 'user2',
              valueCategories: {
                family: 80,
                security: 85,
                health: 75,
                relationships: 85,
                spirituality: 70,
                growth: 68,
              },
              personalityScores: {
                agreeableness: 82,
                conscientiousness: 79,
                extroversion: 72,
                openness: 68,
                emotionalStability: 83,
                optimism: 77,
                empathy: 85,
              },
              interests: [
                { category: 'reading', intensity: 7 },
                { category: 'music', intensity: 8 },
                { category: 'gardening', intensity: 5 },
              ],
            },
          };

          // Îã®Í≥ÑÎ≥Ñ ÏßÑÌñâ ÏãúÎÆ¨Î†àÏù¥ÏÖò
          loadingManager.nextStep('Í∞ÄÏπòÍ¥Ä Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Ï§ë...');
          await new Promise(resolve => setTimeout(resolve, 300));

          loadingManager.nextStep('ÌïµÏã¨ Ìò∏ÌôòÏÑ± Í≥ÑÏÇ∞ Ï§ë...');
          await new Promise(resolve => setTimeout(resolve, 400));

          loadingManager.nextStep('4060ÏÑ∏ÎåÄ ÌäπÏÑ± Ï†ÅÏö© Ï§ë...');
          await new Promise(resolve => setTimeout(resolve, 300));

          loadingManager.nextStep('Îß§Ïπ≠ Í∑ºÍ±∞ Î∂ÑÏÑù Ï§ë...');
          await new Promise(resolve => setTimeout(resolve, 500));

          loadingManager.nextStep('ÎßåÎÇ® Í∞ÄÏù¥Îìú ÏÉùÏÑ± Ï§ë...');

          // Î°úÏª¨ÏóêÏÑú Îß§Ïπ≠ ÏóîÏßÑ ÏßÅÏ†ë Ïã§Ìñâ (ÏÑúÎ≤Ñ API ÏóÜÏù¥)
          const matchingResult = await simulateMatching(testData.user1, testData.user2);

          await new Promise(resolve => setTimeout(resolve, 300));

          const endTime = performance.now();
          const processingTime = endTime - startTime;

          loadingManager.complete(`Îß§Ïπ≠ Î∂ÑÏÑù ÏôÑÎ£å! ${matchingResult.overallScore}Ï†ê`);

          log(`‚úÖ Îß§Ïπ≠ Î∂ÑÏÑù ÏôÑÎ£å! Ï†êÏàò: ${matchingResult.overallScore}Ï†ê`);
          log(`‚ö° Ï≤òÎ¶¨ ÏãúÍ∞Ñ: ${processingTime.toFixed(2)}ms`);

          const resultHTML = `
                    <div class="score-display">${matchingResult.overallScore}Ï†ê</div>
                    <div class="performance-stats">
                        <div class="performance-item">‚ö° Ï≤òÎ¶¨ ÏãúÍ∞Ñ: ${processingTime.toFixed(
                          2
                        )}ms</div>
                        <div class="performance-item">üéØ Ïã†Î¢∞ÎèÑ: ${
                          matchingResult.confidenceLevel
                        }%</div>
                        <div class="performance-item">üìä Î≤ÑÏ†Ñ: ${matchingResult.version}</div>
                    </div>
                    
                    <h4>üìä 5Í∞ú ÏòÅÏó≠ ÏÑ∏Î∂Ä Ï†êÏàò</h4>
                    <div class="score-details">
                        <div class="score-item">
                            <div class="score-value">${Math.round(
                              matchingResult.compatibility.breakdown.coreValues || 0
                            )}</div>
                            <div class="score-label">ÌïµÏã¨ Í∞ÄÏπòÍ¥Ä (35%)</div>
                        </div>
                        <div class="score-item">
                            <div class="score-value">${Math.round(
                              matchingResult.compatibility.breakdown.personalityFit || 0
                            )}</div>
                            <div class="score-label">ÏÑ±Í≤© Í∂ÅÌï© (25%)</div>
                        </div>
                        <div class="score-item">
                            <div class="score-value">${Math.round(
                              matchingResult.compatibility.breakdown.lifestyleCompat || 0
                            )}</div>
                            <div class="score-label">ÎùºÏù¥ÌîÑÏä§ÌÉÄÏùº (20%)</div>
                        </div>
                        <div class="score-item">
                            <div class="score-value">${Math.round(
                              matchingResult.compatibility.breakdown.communicationSync || 0
                            )}</div>
                            <div class="score-label">ÏÜåÌÜµ Ïä§ÌÉÄÏùº (12%)</div>
                        </div>
                        <div class="score-item">
                            <div class="score-value">${Math.round(
                              matchingResult.compatibility.breakdown.growthPotential || 0
                            )}</div>
                            <div class="score-label">ÏÑ±Ïû• Í∞ÄÎä•ÏÑ± (8%)</div>
                        </div>
                    </div>
                    
                    <h4>üí° Îß§Ïπ≠ Ïù¥Ïú† TOP 5</h4>
                    <div class="matching-reasons">
                        ${matchingResult.matchingReasons
                          .map(
                            (reason, index) => `
                            <div class="reason-item">
                                <div class="reason-title">
                                    ${index + 1}. ${reason.title}
                                    <span class="importance-badge">${Math.round(
                                      reason.importance
                                    )}Ï†ê</span>
                                </div>
                                <div class="reason-description">${reason.description}</div>
                            </div>
                        `
                          )
                          .join('')}
                    </div>
                `;

          showResult('matchingResult', resultHTML, true);
          updateStatus(
            `‚úÖ Phase 3 Îß§Ïπ≠ ÏôÑÎ£å! ${matchingResult.overallScore}Ï†ê (${processingTime.toFixed(
              2
            )}ms)`
          );
        } catch (error) {
          loadingManager.setError(`Îß§Ïπ≠ Î∂ÑÏÑù Ïã§Ìå®: ${error.message}`);
          log(`‚ùå Îß§Ïπ≠ ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${error.message}`);
          showResult('matchingResult', `‚ùå Îß§Ïπ≠ ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${error.message}`, false);
          updateStatus('‚ùå Îß§Ïπ≠ ÌÖåÏä§Ìä∏ Ïã§Ìå®!');
        }
      }

      // Îß§Ïπ≠ ÏãúÎÆ¨Î†àÏù¥ÏÖò Ìï®Ïàò (Ïã§Ï†ú Îß§Ïπ≠ ÏóîÏßÑ Î°úÏßÅ Í∞ÑÏÜåÌôî Î≤ÑÏ†Ñ)
      async function simulateMatching(user1, user2) {
        // Í∏∞Î≥∏ Ìò∏ÌôòÏÑ± Í≥ÑÏÇ∞
        const coreValues = calculateCoreValuesCompatibility(user1, user2);
        const personalityFit = calculatePersonalityCompatibility(user1, user2);
        const lifestyleCompat = calculateLifestyleCompatibility(user1, user2);
        const communicationSync = calculateCommunicationCompatibility(user1, user2);
        const growthPotential = calculateGrowthPotential(user1, user2);

        // Í∞ÄÏ§ëÏπò Ï†ÅÏö©
        const weights = {
          coreValues: 0.35,
          personalityFit: 0.25,
          lifestyleCompat: 0.2,
          communicationSync: 0.12,
          growthPotential: 0.08,
        };

        let overallScore =
          coreValues * weights.coreValues +
          personalityFit * weights.personalityFit +
          lifestyleCompat * weights.lifestyleCompat +
          communicationSync * weights.communicationSync +
          growthPotential * weights.growthPotential;

        // 4060ÏÑ∏ÎåÄ Î≥¥ÎÑàÏä§ Ï†ÅÏö©
        const ageGroupBonus = calculateAgeGroupBonus(user1, user2);
        overallScore *= 1 + ageGroupBonus;

        // Îß§Ïπ≠ Ïù¥Ïú† ÏÉùÏÑ±
        const matchingReasons = generateMatchingReasons(user1, user2, {
          coreValues,
          personalityFit,
          lifestyleCompat,
          communicationSync,
          growthPotential,
        });

        return {
          overallScore: Math.round(overallScore),
          compatibility: {
            breakdown: {
              coreValues,
              personalityFit,
              lifestyleCompat,
              communicationSync,
              growthPotential,
            },
          },
          matchingReasons,
          confidenceLevel: 94,
          version: '3.0',
          timestamp: new Date(),
        };
      }

      // Ìò∏ÌôòÏÑ± Í≥ÑÏÇ∞ Ìï®ÏàòÎì§
      function calculateCoreValuesCompatibility(user1, user2) {
        const categories = [
          'family',
          'security',
          'health',
          'relationships',
          'spirituality',
          'growth',
        ];
        let totalCompatibility = 0;

        categories.forEach(category => {
          const score1 = user1.valueCategories[category] || 50;
          const score2 = user2.valueCategories[category] || 50;
          const similarity = Math.max(0, 100 - Math.abs(score1 - score2));
          totalCompatibility += similarity;
        });

        return totalCompatibility / categories.length;
      }

      function calculatePersonalityCompatibility(user1, user2) {
        const traits = [
          'agreeableness',
          'conscientiousness',
          'extroversion',
          'openness',
          'emotionalStability',
        ];
        let totalCompatibility = 0;

        traits.forEach(trait => {
          const score1 = user1.personalityScores[trait] || 50;
          const score2 = user2.personalityScores[trait] || 50;
          const similarity = Math.max(0, 100 - Math.abs(score1 - score2));
          totalCompatibility += similarity;
        });

        return totalCompatibility / traits.length;
      }

      function calculateLifestyleCompatibility(user1, user2) {
        // Í¥ÄÏã¨ÏÇ¨ Í∏∞Î∞ò Ìò∏ÌôòÏÑ±
        const interests1 = new Set(user1.interests?.map(i => i.category) || []);
        const interests2 = new Set(user2.interests?.map(i => i.category) || []);
        const commonInterests = [...interests1].filter(i => interests2.has(i));
        const interestCompatibility =
          (commonInterests.length / Math.max(interests1.size, interests2.size, 1)) * 100;

        // Í±¥Í∞ï Í∞ÄÏπòÍ¥Ä Í∏∞Î∞ò
        const health1 = user1.valueCategories?.health || 50;
        const health2 = user2.valueCategories?.health || 50;
        const healthCompatibility = Math.max(0, 100 - Math.abs(health1 - health2));

        return interestCompatibility * 0.6 + healthCompatibility * 0.4;
      }

      function calculateCommunicationCompatibility(user1, user2) {
        const agreeableness1 = user1.personalityScores?.agreeableness || 50;
        const agreeableness2 = user2.personalityScores?.agreeableness || 50;
        const empathy1 = user1.personalityScores?.empathy || 50;
        const empathy2 = user2.personalityScores?.empathy || 50;

        const agreeablenessCompat = Math.max(0, 100 - Math.abs(agreeableness1 - agreeableness2));
        const empathyCompat = Math.max(0, 100 - Math.abs(empathy1 - empathy2));

        return (agreeablenessCompat + empathyCompat) / 2;
      }

      function calculateGrowthPotential(user1, user2) {
        const openness1 = user1.personalityScores?.openness || 50;
        const openness2 = user2.personalityScores?.openness || 50;
        const growth1 = user1.valueCategories?.growth || 50;
        const growth2 = user2.valueCategories?.growth || 50;

        const opennessCompat = Math.max(0, 100 - Math.abs(openness1 - openness2));
        const growthAverage = (growth1 + growth2) / 2;

        return opennessCompat * 0.6 + growthAverage * 0.4;
      }

      function calculateAgeGroupBonus(user1, user2) {
        // 4060ÏÑ∏ÎåÄ ÌäπÏÑ± Î∞òÏòÅ Î≥¥ÎÑàÏä§
        let bonus = 0;

        // Í∞ÄÏ°± Í∞ÄÏπòÍ¥Ä Î≥¥ÎÑàÏä§
        const family1 = user1.valueCategories?.family || 50;
        const family2 = user2.valueCategories?.family || 50;
        if (family1 > 75 && family2 > 75) bonus += 0.08;

        // ÏïàÏ†ïÏÑ± Î≥¥ÎÑàÏä§
        const security1 = user1.valueCategories?.security || 50;
        const security2 = user2.valueCategories?.security || 50;
        if (security1 > 70 && security2 > 70) bonus += 0.05;

        // Ï†ïÏÑúÏ†Å ÏïàÏ†ïÏÑ± Î≥¥ÎÑàÏä§
        const emotional1 = user1.personalityScores?.emotionalStability || 50;
        const emotional2 = user2.personalityScores?.emotionalStability || 50;
        if (emotional1 > 70 && emotional2 > 70) bonus += 0.03;

        return bonus;
      }

      function generateMatchingReasons(user1, user2, scores) {
        const reasons = [];

        // Í∞ÄÏπòÍ¥Ä ÏùºÏπò Ïù¥Ïú†Îì§
        if (user1.valueCategories.family > 70 && user2.valueCategories.family > 70) {
          reasons.push({
            title: 'Í∞ÄÏ°±Í≥ºÏùò Ïú†ÎåÄ',
            description:
              'Í∞ÄÏ°±Í≥ºÏùò Ïú†ÎåÄÎ•º Îß§Ïö∞ Ï§ëÏãúÌïòÏãúÎäî Í≥µÌÜµÏ†êÏù¥ ÏûàÏñ¥, Îî∞ÎúªÌïòÍ≥† ÏïàÏ†ïÏ†ÅÏù∏ Í¥ÄÍ≥ÑÎ•º ÎßåÎì§Ïñ¥Í∞à Ïàò ÏûàÏùÑ Í≤É Í∞ôÏäµÎãàÎã§',
            importance: Math.min(user1.valueCategories.family, user2.valueCategories.family) + 10,
          });
        }

        if (user1.valueCategories.health > 70 && user2.valueCategories.health > 70) {
          reasons.push({
            title: 'Í±¥Í∞ïÌïú ÏÇ∂',
            description:
              'Í±¥Í∞ïÌïú ÏÇ∂ÏùÑ Ï§ëÏãúÌïòÎäî ÎßàÏùåÏù¥ ÌÜµÌï¥, Ìï®Íªò Í±¥Í∞ïÌïú ÏÉùÌôúÏùÑ ÎßåÎì§Ïñ¥Í∞à Ïàò ÏûàÏäµÎãàÎã§',
            importance: Math.min(user1.valueCategories.health, user2.valueCategories.health) + 15,
          });
        }

        if (user1.valueCategories.relationships > 70 && user2.valueCategories.relationships > 70) {
          reasons.push({
            title: 'Ïù∏Í∞ÑÍ¥ÄÍ≥Ñ',
            description:
              'Ï¢ãÏùÄ Ïù∏Í∞ÑÍ¥ÄÍ≥ÑÏùò Ï§ëÏöîÏÑ±ÏùÑ Í≥µÍ∞êÌïòÏãúÏñ¥, ÏÑúÎ°úÎ•º Ïù¥Ìï¥ÌïòÍ≥† Î∞∞Î†§ÌïòÎäî Í¥ÄÍ≥ÑÍ∞Ä Í∞ÄÎä•Ìï©ÎãàÎã§',
            importance:
              Math.min(user1.valueCategories.relationships, user2.valueCategories.relationships) +
              5,
          });
        }

        if (user1.valueCategories.security > 70 && user2.valueCategories.security > 70) {
          reasons.push({
            title: 'ÏïàÏ†ïÍ≥º ÌèâÌôî',
            description:
              'ÏïàÏ†ïÍ≥º ÌèâÌôîÎ•º Ï∂îÍµ¨ÌïòÎäî Í∞ÄÏπòÍ¥ÄÏù¥ ÏùºÏπòÌïòÏó¨, ÏÑúÎ°úÏóêÍ≤å Îì†Îì†Ìïú ÏßÄÏßÄÎåÄÍ∞Ä Îê† Ïàò ÏûàÏäµÎãàÎã§',
            importance: Math.min(user1.valueCategories.security, user2.valueCategories.security),
          });
        }

        // ÏÑ±Í≤© Ïú†ÏÇ¨ÏÑ±
        if (
          user1.personalityScores.agreeableness > 70 &&
          user2.personalityScores.agreeableness > 70
        ) {
          reasons.push({
            title: 'ÏπúÌôîÏÑ±Í≥º Î∞∞Î†§Ïã¨',
            description:
              'Îëê Î∂Ñ Î™®Îëê Îã§Î•∏ ÏÇ¨ÎûåÏùÑ Î∞∞Î†§ÌïòÍ≥† Ïù¥Ìï¥ÌïòÎ†§Îäî ÎßàÏùåÏù¥ ÌÅ¨ÏãúÏñ¥, Ï°∞ÌôîÎ°úÏö¥ Í¥ÄÍ≥ÑÎ•º ÎßåÎì§Ïñ¥Í∞à Ïàò ÏûàÏäµÎãàÎã§',
            importance:
              ((user1.personalityScores.agreeableness + user2.personalityScores.agreeableness) /
                2) *
              0.9,
          });
        }

        return reasons.sort((a, b) => b.importance - a.importance).slice(0, 5);
      }

      // 3. Îã§Ï§ë Îß§Ïπ≠ ÌÖåÏä§Ìä∏
      async function testMultipleMatches() {
        const steps = [
          { title: 'ÌÖåÏä§Ìä∏ Ï¥àÍ∏∞Ìôî', description: '10Ìöå Ïó∞ÏÜç Îß§Ïπ≠ ÌÖåÏä§Ìä∏ Ï§ÄÎπÑ' },
          { title: '1-3Ìöå ÌÖåÏä§Ìä∏', description: 'Ï¥àÍ∏∞ Îß§Ïπ≠ ÏÑ±Îä• ÌôïÏù∏' },
          { title: '4-6Ìöå ÌÖåÏä§Ìä∏', description: 'ÏùºÍ¥ÄÏÑ± Í≤ÄÏ¶ù' },
          { title: '7-10Ìöå ÌÖåÏä§Ìä∏', description: 'ÏµúÏ¢Ö ÏÑ±Îä• Ï∏°Ï†ï' },
          { title: 'Í≤∞Í≥º Î∂ÑÏÑù', description: 'ÌÜµÍ≥Ñ Î∞è ÏÑ±Îä• ÏßÄÌëú Í≥ÑÏÇ∞' },
        ];

        loadingManager.show(
          'Îã§Ï§ë Îß§Ïπ≠ ÏÑ±Îä• ÌÖåÏä§Ìä∏',
          '10Ìöå Ïó∞ÏÜç Îß§Ïπ≠ÏúºÎ°ú ÏãúÏä§ÌÖú ÏïàÏ†ïÏÑ±ÏùÑ Í≤ÄÏ¶ùÌï©ÎãàÎã§',
          steps,
          '8-10Ï¥à'
        );

        await new Promise(resolve => setTimeout(resolve, 500));

        const results = [];
        const startTime = performance.now();

        loadingManager.nextStep('ÌÖåÏä§Ìä∏ ÌôòÍ≤Ω ÏÑ§Ï†ï Ï§ë...');

        for (let i = 0; i < 10; i++) {
          // Îã®Í≥ÑÎ≥Ñ ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
          if (i === 0) loadingManager.nextStep('1-3Ìöå ÌÖåÏä§Ìä∏ ÏßÑÌñâ Ï§ë...');
          else if (i === 3) loadingManager.nextStep('4-6Ìöå ÌÖåÏä§Ìä∏ ÏßÑÌñâ Ï§ë...');
          else if (i === 6) loadingManager.nextStep('7-10Ìöå ÌÖåÏä§Ìä∏ ÏßÑÌñâ Ï§ë...');

          const result = await simulateMatching(
            {
              userId: 'user1',
              valueCategories: {
                family: 85,
                security: 75,
                health: 80,
                relationships: 90,
                spirituality: 65,
                growth: 70,
              },
              personalityScores: {
                agreeableness: 78,
                conscientiousness: 85,
                extroversion: 65,
                openness: 71,
                emotionalStability: 80,
                optimism: 75,
                empathy: 82,
              },
              interests: [],
            },
            {
              userId: 'user2',
              valueCategories: {
                family: 80,
                security: 85,
                health: 75,
                relationships: 85,
                spirituality: 70,
                growth: 68,
              },
              personalityScores: {
                agreeableness: 82,
                conscientiousness: 79,
                extroversion: 72,
                openness: 68,
                emotionalStability: 83,
                optimism: 77,
                empathy: 85,
              },
              interests: [],
            }
          );

          results.push(result.overallScore);
          log(`‚úÖ ÌÖåÏä§Ìä∏ ${i + 1}: ${result.overallScore}Ï†ê`);

          // ÏßßÏùÄ ÎåÄÍ∏∞ ÏãúÍ∞Ñ (UI ÏóÖÎç∞Ïù¥Ìä∏Ïö©)
          await new Promise(resolve => setTimeout(resolve, 100));
        }

        loadingManager.nextStep('Í≤∞Í≥º Î∂ÑÏÑù Î∞è ÌÜµÍ≥Ñ Í≥ÑÏÇ∞ Ï§ë...');

        const endTime = performance.now();
        const totalTime = endTime - startTime;
        const avgTime = totalTime / 10;
        const avgScore = results.reduce((sum, score) => sum + score, 0) / results.length;
        const consistency = results.every(score => score === results[0]) ? '100%' : 'ÌòºÌï©';

        log(`‚úÖ Îã§Ï§ë Îß§Ïπ≠ ÌÖåÏä§Ìä∏ ÏôÑÎ£å!`);
        log(`üìä ÌèâÍ∑† Ï†êÏàò: ${avgScore.toFixed(1)}Ï†ê`);
        log(`‚ö° ÌèâÍ∑† Ï≤òÎ¶¨ ÏãúÍ∞Ñ: ${avgTime.toFixed(2)}ms`);
        log(`üîÑ ÏùºÍ¥ÄÏÑ±: ${consistency}`);

        const resultHTML = `
                <h4>‚úÖ 10Ìöå Ïó∞ÏÜç Îß§Ïπ≠ ÌÖåÏä§Ìä∏ ÏôÑÎ£å</h4>
                <div class="performance-stats">
                    <div class="performance-item">üìä ÌèâÍ∑† Ï†êÏàò: ${avgScore.toFixed(1)}Ï†ê</div>
                    <div class="performance-item">‚ö° ÌèâÍ∑† ÏãúÍ∞Ñ: ${avgTime.toFixed(2)}ms</div>
                    <div class="performance-item">üîÑ ÏùºÍ¥ÄÏÑ±: ${consistency}</div>
                </div>
                <p><strong>Î™®Îì† ÌÖåÏä§Ìä∏ Í≤∞Í≥º:</strong> ${results.join(', ')}Ï†ê</p>
                <p><strong>ÏÑ±Îä• Î™©Ìëú Îã¨ÏÑ±:</strong> ${
                  avgTime < 1 ? '‚úÖ 0.5ms Î™©Ìëú Îã¨ÏÑ±!' : '‚ö†Ô∏è Î™©Ìëú ÏãúÍ∞Ñ Ï¥àÍ≥º'
                }</p>
            `;

        await new Promise(resolve => setTimeout(resolve, 300));

        loadingManager.complete(`Îã§Ï§ë ÌÖåÏä§Ìä∏ ÏôÑÎ£å! ÌèâÍ∑† ${avgScore.toFixed(1)}Ï†ê`);

        showResult('matchingResult', resultHTML, true);
        updateStatus(
          `‚úÖ Îã§Ï§ë ÌÖåÏä§Ìä∏ ÏôÑÎ£å! ÌèâÍ∑† ${avgScore.toFixed(1)}Ï†ê (${avgTime.toFixed(2)}ms)`
        );
      }

      // 4. Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÌÖåÏä§Ìä∏
      async function testValuesAnalysis() {
        log('üß≠ Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÏóîÏßÑ ÌÖåÏä§Ìä∏ ÏãúÏûë...');
        updateStatus('üß≠ 5Ï∞®Ïõê Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù Ïã§Ìñâ Ï§ë...');

        try {
          const testAnswers = new Map([
            ['1', { value: 'family', weights: { family: 5, relationships: 4 } }],
            ['2', { value: 'quality', weights: { relationships: 5, agreeableness: 4 } }],
            ['3', { value: 'experience', weights: { growth: 3, openness: 3 } }],
            ['4', { value: 'support', weights: { family: 4, empathy: 5 } }],
            ['5', { value: 'mediate', weights: { agreeableness: 4, empathy: 3 } }],
          ]);

          const analysisResult = await simulateValuesAnalysis('test-user', testAnswers);

          log(`‚úÖ Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÏôÑÎ£å!`);
          log(`üéØ Ï£ºÏöî Í∞ÄÏπòÍ¥Ä: ${analysisResult.valueProfile.primaryValues[0].name}`);
          log(
            `üí¨ ÏÜåÌÜµ Ïä§ÌÉÄÏùº: ${analysisResult.valueProfile.personalityProfile.communicationStyle}`
          );

          const resultHTML = `
                    <h4>üß≠ 5Ï∞®Ïõê Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÏôÑÎ£å</h4>
                    <p><strong>ÌïµÏã¨ Î©îÏãúÏßÄ:</strong> ${
                      analysisResult.analysisResult.coreMessage
                    }</p>
                    
                    <h5>üìä Ï£ºÏöî Í∞ÄÏπòÍ¥Ä TOP 3</h5>
                    <div class="score-details">
                        ${analysisResult.valueProfile.primaryValues
                          .map(
                            (value, index) => `
                            <div class="score-item">
                                <div class="score-value">${Math.round(value.score)}</div>
                                <div class="score-label">${index + 1}. ${value.name}</div>
                            </div>
                        `
                          )
                          .join('')}
                    </div>
                    
                    <h5>ü§ù ÏÑ±Í≤© ÌîÑÎ°úÌïÑ</h5>
                    <p><strong>ÏÜåÌÜµ Ïä§ÌÉÄÏùº:</strong> ${
                      analysisResult.valueProfile.personalityProfile.communicationStyle
                    }</p>
                    <p><strong>ÏùòÏÇ¨Í≤∞Ï†ï:</strong> ${
                      analysisResult.valueProfile.personalityProfile.decisionMaking
                    }</p>
                    <p><strong>Í∞àÎì± Ìï¥Í≤∞:</strong> ${
                      analysisResult.valueProfile.personalityProfile.conflictResolution
                    }</p>
                    
                    <p><strong>Î∂ÑÏÑù Ïã†Î¢∞ÎèÑ:</strong> ${analysisResult.confidence}%</p>
                `;

          showResult('valuesResult', resultHTML, true);
          updateStatus(`‚úÖ Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÏôÑÎ£å! Ïã†Î¢∞ÎèÑ ${analysisResult.confidence}%`);
        } catch (error) {
          log(`‚ùå Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù Ïã§Ìå®: ${error.message}`);
          showResult('valuesResult', `‚ùå Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù Ïã§Ìå®: ${error.message}`, false);
        }
      }

      // Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù ÏãúÎÆ¨Î†àÏù¥ÏÖò
      async function simulateValuesAnalysis(userId, answers) {
        const valueProfile = {
          primaryValues: [
            {
              dimension: 'relationshipValues',
              name: 'Í¥ÄÍ≥ÑÍ¥Ä',
              score: 100,
              description: 'Ïù∏Í∞ÑÍ¥ÄÍ≥ÑÏóê ÎåÄÌïú Í∞ÄÏπòÏôÄ Ï†ëÍ∑ºÎ≤ï',
            },
            {
              dimension: 'stabilityGrowth',
              name: 'ÏïàÏ†ï-ÏÑ±Ïû• Í∑†Ìòï',
              score: 85,
              description: 'ÏïàÏ†ïÍ≥º ÏÉàÎ°úÏö¥ ÎèÑÏ†Ñ ÏÇ¨Ïù¥Ïùò Í∑†ÌòïÏ†ê',
            },
            {
              dimension: 'healthWellness',
              name: 'Í±¥Í∞ïÍ¥Ä',
              score: 80,
              description: 'Ïã†Ï≤¥Ï†Å, Ï†ïÏã†Ï†Å Í±¥Í∞ïÏóê ÎåÄÌïú Í∞ÄÏπòÍ¥Ä',
            },
          ],
          personalityProfile: {
            communicationStyle: 'diplomatic',
            decisionMaking: 'experienced',
            conflictResolution: 'collaborative',
          },
        };

        const analysisResult = {
          coreMessage:
            'ÏßÑÏ†ïÌïú Ïù∏Í∞ÑÍ¥ÄÍ≥ÑÏôÄ ÏÜåÌÜµÏùÑ Ï§ëÏãúÌïòÎäî Îî∞ÎúªÌïú Î∂ÑÏûÖÎãàÎã§. Î∞∞Î†§ ÍπäÍ≥† ÌòëÎ†•Ï†ÅÏù∏ ÏÑ±Ìñ•ÏùÑ ÌÜµÌï¥ ÎçîÏö± ÌíçÏÑ±Ìïú Ïù∏ÏÉùÏùÑ ÎßåÎì§Ïñ¥Í∞ÄÍ≥† Í≥ÑÏã≠ÎãàÎã§.',
        };

        return {
          userId,
          valueProfile,
          analysisResult,
          confidence: 94,
          timestamp: new Date(),
        };
      }

      // 5. ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÌÖåÏä§Ìä∏
      async function testVisualization() {
        log('üé® ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± ÌÖåÏä§Ìä∏ ÏãúÏûë...');
        updateStatus('üé® Îß§Ïπ≠ ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Ï§ë...');

        try {
          const visualData = await simulateVisualization();

          log(`‚úÖ ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± ÏôÑÎ£å!`);
          log(`üìà ÏãúÍ∞ÅÌôî ÏöîÏÜå: ${visualData.visualizations.length}Í∞ú`);

          const resultHTML = `
                    <h4>üé® ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± ÏôÑÎ£å</h4>
                    <p><strong>Ï†ÑÏ≤¥ Ìò∏ÌôòÏÑ±:</strong> ${visualData.overallCompatibility.score}Ï†ê</p>
                    <p><strong>Ìò∏ÌôòÏÑ± Î†àÎ≤®:</strong> ${visualData.overallCompatibility.level}</p>
                    <p><strong>ÏÉâÏÉÅ ÏΩîÎìú:</strong> <span style="color: ${
                      visualData.overallCompatibility.color
                    };">${visualData.overallCompatibility.color}</span></p>
                    
                    <h5>üìä ÏÉùÏÑ±Îêú ÏãúÍ∞ÅÌôî ÏöîÏÜå</h5>
                    <ul>
                        ${visualData.visualizations
                          .map(
                            viz => `
                            <li><strong>${viz.type}:</strong> ${viz.description} (Îç∞Ïù¥ÌÑ∞ ${viz.dataPoints}Í∞ú)</li>
                        `
                          )
                          .join('')}
                    </ul>
                `;

          showResult('visualResult', resultHTML, true);
          updateStatus(`‚úÖ ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± ÏôÑÎ£å! ${visualData.visualizations.length}Í∞ú ÏöîÏÜå`);
        } catch (error) {
          log(`‚ùå ÏãúÍ∞ÅÌôî ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${error.message}`);
          showResult('visualResult', `‚ùå ÏãúÍ∞ÅÌôî ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${error.message}`, false);
        }
      }

      // ÏãúÍ∞ÅÌôî Îç∞Ïù¥ÌÑ∞ ÏãúÎÆ¨Î†àÏù¥ÏÖò
      async function simulateVisualization() {
        return {
          overallCompatibility: {
            score: 104,
            level: 'ÏµúÏÉÅÏùò Í∂ÅÌï© üíñ',
            color: '#10b981',
            description:
              'Îß§Ïö∞ ÎÜíÏùÄ Ìò∏ÌôòÏÑ±ÏùÑ Î≥¥Ïù¥Î©∞, ÏÑúÎ°úÏóêÍ≤å Ïù¥ÏÉÅÏ†ÅÏù∏ ÌååÌä∏ÎÑàÍ∞Ä Îê† Í∞ÄÎä•ÏÑ±Ïù¥ ÌÅΩÎãàÎã§.',
          },
          visualizations: [
            { type: 'Ï†ÑÏ≤¥ Ìò∏ÌôòÏÑ± Ï∞®Ìä∏', description: 'ÏõêÌòï Í≤åÏù¥ÏßÄ Ï∞®Ìä∏', dataPoints: 1 },
            { type: '5Í∞ú ÏòÅÏó≠ Î∂ÑÏÑù', description: 'Î†àÏù¥Îçî Ï∞®Ìä∏', dataPoints: 5 },
            { type: 'Í∞ÄÏπòÍ¥Ä ÎπÑÍµê', description: 'ÎßâÎåÄ Í∑∏ÎûòÌîÑ', dataPoints: 6 },
            { type: 'ÏÑ±Í≤© Í∂ÅÌï©', description: 'ÏÇ∞Ï†êÎèÑ', dataPoints: 7 },
            { type: 'Îß§Ïπ≠ Ïù¥Ïú†', description: 'Ïö∞ÏÑ†ÏàúÏúÑ Î¶¨Ïä§Ìä∏', dataPoints: 5 },
            { type: 'ÏÑ±Ïû• Í∞ÄÎä•ÏÑ±', description: 'Ìä∏Î†åÎìú ÎùºÏù∏', dataPoints: 3 },
            { type: 'ÏÜåÌÜµ Ïä§ÌÉÄÏùº', description: 'Î≤§ Îã§Ïù¥Ïñ¥Í∑∏Îû®', dataPoints: 4 },
            { type: 'ÎùºÏù¥ÌîÑÏä§ÌÉÄÏùº', description: 'ÌûàÌä∏Îßµ', dataPoints: 8 },
          ],
        };
      }

      // 6. ÏÑ±Îä• Ï¢ÖÌï© ÌÖåÏä§Ìä∏
      async function runPerformanceTest() {
        log('üöÄ ÏÑ±Îä• Ï¢ÖÌï© ÌÖåÏä§Ìä∏ ÏãúÏûë...');
        updateStatus('üöÄ Phase 3 ÏãúÏä§ÌÖú Ï¢ÖÌï© ÏÑ±Îä• Ï∏°Ï†ï Ï§ë...');

        const testResults = {
          matchingTests: [],
          valuesTests: [],
          visualizationTests: [],
        };

        // Îß§Ïπ≠ ÏÑ±Îä• ÌÖåÏä§Ìä∏ (100Ìöå)
        log('‚ö° Îß§Ïπ≠ ÏóîÏßÑ ÏÑ±Îä• ÌÖåÏä§Ìä∏ (100Ìöå)...');
        const matchingStartTime = performance.now();
        for (let i = 0; i < 100; i++) {
          const startTime = performance.now();
          await simulateMatching(
            {
              userId: 'user1',
              valueCategories: { family: 85, security: 75, health: 80, relationships: 90 },
              personalityScores: { agreeableness: 78, conscientiousness: 85 },
              interests: [],
            },
            {
              userId: 'user2',
              valueCategories: { family: 80, security: 85, health: 75, relationships: 85 },
              personalityScores: { agreeableness: 82, conscientiousness: 79 },
              interests: [],
            }
          );
          testResults.matchingTests.push(performance.now() - startTime);
        }
        const matchingEndTime = performance.now();

        // ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
        const avgMatchingTime =
          testResults.matchingTests.reduce((sum, time) => sum + time, 0) /
          testResults.matchingTests.length;
        const maxMatchingTime = Math.max(...testResults.matchingTests);
        const minMatchingTime = Math.min(...testResults.matchingTests);
        const totalMatchingTime = matchingEndTime - matchingStartTime;
        const tps = (100 / (totalMatchingTime / 1000)).toFixed(0);

        log(`‚úÖ ÏÑ±Îä• ÌÖåÏä§Ìä∏ ÏôÑÎ£å!`);
        log(`üìä ÌèâÍ∑† Ï≤òÎ¶¨ ÏãúÍ∞Ñ: ${avgMatchingTime.toFixed(2)}ms`);
        log(`‚ö° TPS: ${tps}Ìöå/Ï¥à`);

        const resultHTML = `
                <h4>üöÄ Phase 3 ÏãúÏä§ÌÖú ÏÑ±Îä• Ï∏°Ï†ï ÏôÑÎ£å</h4>
                <div class="performance-stats">
                    <div class="performance-item">üìä ÌèâÍ∑† ÏãúÍ∞Ñ: ${avgMatchingTime.toFixed(
                      2
                    )}ms</div>
                    <div class="performance-item">‚ö° TPS: ${tps}Ìöå/Ï¥à</div>
                    <div class="performance-item">üéØ Î™©Ìëú Îã¨ÏÑ±: ${
                      avgMatchingTime < 1 ? '‚úÖ' : '‚ùå'
                    }</div>
                </div>
                
                <h5>üìà ÏÉÅÏÑ∏ ÏÑ±Îä• ÏßÄÌëú</h5>
                <p><strong>ÏµúÏÜå ÏãúÍ∞Ñ:</strong> ${minMatchingTime.toFixed(2)}ms</p>
                <p><strong>ÏµúÎåÄ ÏãúÍ∞Ñ:</strong> ${maxMatchingTime.toFixed(2)}ms</p>
                <p><strong>Ï¥ù ÌÖåÏä§Ìä∏ ÏãúÍ∞Ñ:</strong> ${totalMatchingTime.toFixed(2)}ms</p>
                <p><strong>Î∂ÑÎãπ Ï≤òÎ¶¨Îüâ:</strong> ${(parseInt(tps) * 60).toLocaleString()}Îß§Ïπ≠/Î∂Ñ</p>
                
                <h5>üéØ ÏÑ±Îä• ÌèâÍ∞Ä</h5>
                <p><strong>Î™©Ìëú 0.5ms:</strong> ${
                  avgMatchingTime < 0.5
                    ? '‚úÖ Îã¨ÏÑ±'
                    : avgMatchingTime < 1
                    ? '‚ö° Ïö∞Ïàò'
                    : '‚ö†Ô∏è Í∞úÏÑ† ÌïÑÏöî'
                }</p>
                <p><strong>ÏïàÏ†ïÏÑ±:</strong> ${
                  maxMatchingTime - minMatchingTime < 1 ? '‚úÖ Îß§Ïö∞ ÏïàÏ†ï' : '‚ö†Ô∏è Î≥ÄÎèô ÏûàÏùå'
                }</p>
            `;

        showResult('performanceResult', resultHTML, true);
        updateStatus(`‚úÖ ÏÑ±Îä• ÌÖåÏä§Ìä∏ ÏôÑÎ£å! ÌèâÍ∑† ${avgMatchingTime.toFixed(2)}ms (${tps} TPS)`);
      }

      // ========== Í∞úÏù∏Ìôî ÏãúÏä§ÌÖú (ÏôÑÏ†ÑÏ≤¥++ 2Îã®Í≥Ñ) ==========

      class PersonalizationEngine {
        constructor() {
          this.userHistory = new Map(); // ÏÇ¨Ïö©ÏûêÎ≥Ñ Îß§Ïπ≠ ÌûàÏä§ÌÜ†Î¶¨
          this.preferenceModel = new Map(); // ÏÇ¨Ïö©ÏûêÎ≥Ñ ÏÑ†Ìò∏ÎèÑ Î™®Îç∏
          this.adaptiveWeights = new Map(); // Ï†ÅÏùëÌòï Í∞ÄÏ§ëÏπò
          this.personalInsights = new Map(); // Í∞úÏù∏Î≥Ñ Ïù∏ÏÇ¨Ïù¥Ìä∏
          this.initialized = false;
          this.init();
        }

        init() {
          // 4060ÏÑ∏ÎåÄ ÌäπÌôî Í∏∞Î≥∏ ÏÑ†Ìò∏ÎèÑ ÏÑ§Ï†ï
          this.defaultPreferences = {
            valueWeights: {
              family: 0.25, // Í∞ÄÏ°± Ï§ëÏãú
              security: 0.2, // ÏïàÏ†ïÏÑ± Ï§ëÏãú
              relationships: 0.2, // Í¥ÄÍ≥Ñ Ï§ëÏãú
              health: 0.15, // Í±¥Í∞ï Ï§ëÏãú
              spirituality: 0.1, // ÏòÅÏÑ± Í≥†Î†§
              growth: 0.1, // ÏÑ±Ïû• ÏöïÍµ¨
            },
            personalityWeights: {
              agreeableness: 0.25, // ÏπúÌôîÏÑ± Í∞ÄÏû• Ï§ëÏöî
              conscientiousness: 0.2, // ÏÑ±Ïã§ÏÑ± Ï§ëÏãú
              emotionalStability: 0.2, // Ï†ïÏÑúÏ†Å ÏïàÏ†ïÏÑ±
              empathy: 0.15, // Í≥µÍ∞ê Îä•Î†•
              optimism: 0.1, // ÎÇôÍ¥ÄÏÑ±
              extroversion: 0.05, // Ïô∏Ìñ•ÏÑ±ÏùÄ ÏÉÅÎåÄÏ†ÅÏúºÎ°ú ÎÇÆÏùå
              openness: 0.05, // Í∞úÎ∞©ÏÑ±ÏùÄ ÏÉÅÎåÄÏ†ÅÏúºÎ°ú ÎÇÆÏùå
            },
            matchingThreshold: 65, // Îß§Ïπ≠ ÏûÑÍ≥ÑÍ∞í
            learningRate: 0.1, // ÌïôÏäµÎ•† (Ï†êÏßÑÏ†Å Ï†ÅÏùë)
            minHistoryForAdaptation: 3, // Ï†ÅÏùë ÏãúÏûë ÏµúÏÜå ÌûàÏä§ÌÜ†Î¶¨
          };

          log('üéØ Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
          this.initialized = true;
        }

        // ÏÇ¨Ïö©Ïûê Îß§Ïπ≠ ÌûàÏä§ÌÜ†Î¶¨ Í∏∞Î°ù
        recordMatchingHistory(userId, matchingData, userFeedback) {
          if (!this.userHistory.has(userId)) {
            this.userHistory.set(userId, []);
          }

          const historyEntry = {
            timestamp: new Date().toISOString(),
            matchingData: matchingData,
            feedback: userFeedback, // 'like', 'dislike', 'super_like', 'pass'
            partnerProfile: matchingData.partner,
            finalScore: matchingData.overallScore,
            matchingReasons: matchingData.detailedReasons || [],
          };

          this.userHistory.get(userId).push(historyEntry);

          // ÌûàÏä§ÌÜ†Î¶¨ Í∞úÏàò Ï†úÌïú (ÏµúÏã† 50Í∞úÎßå Î≥¥Í¥Ä)
          if (this.userHistory.get(userId).length > 50) {
            this.userHistory.get(userId).shift();
          }

          log(`üìù ÏÇ¨Ïö©Ïûê ${userId} Îß§Ïπ≠ ÌûàÏä§ÌÜ†Î¶¨ Í∏∞Î°ù: ${userFeedback}`);

          // Ï∂©Î∂ÑÌïú ÌûàÏä§ÌÜ†Î¶¨Í∞Ä ÏåìÏù¥Î©¥ Ï†ÅÏùëÌòï ÌïôÏäµ ÏãúÏûë
          if (
            this.userHistory.get(userId).length >= this.defaultPreferences.minHistoryForAdaptation
          ) {
            this.updatePersonalPreferences(userId);
          }
        }

        // Í∞úÏù∏Î≥Ñ ÏÑ†Ìò∏ÎèÑ ÌïôÏäµ Î∞è ÏóÖÎç∞Ïù¥Ìä∏
        updatePersonalPreferences(userId) {
          const history = this.userHistory.get(userId) || [];
          if (history.length < this.defaultPreferences.minHistoryForAdaptation) {
            return;
          }

          const positiveMatches = history.filter(
            h => h.feedback === 'like' || h.feedback === 'super_like'
          );
          const negativeMatches = history.filter(
            h => h.feedback === 'dislike' || h.feedback === 'pass'
          );

          // Í∏çÏ†ïÏ†Å Îß§Ïπ≠ÏóêÏÑú Ìå®ÌÑ¥ Î∂ÑÏÑù
          const positivePatterns = this.analyzeMatchingPatterns(positiveMatches);
          const negativePatterns = this.analyzeMatchingPatterns(negativeMatches);

          // Ï†ÅÏùëÌòï Í∞ÄÏ§ëÏπò Í≥ÑÏÇ∞
          const adaptiveWeights = this.calculateAdaptiveWeights(positivePatterns, negativePatterns);

          // Í∞úÏù∏Î≥Ñ ÏÑ†Ìò∏ÎèÑ Î™®Îç∏ ÏóÖÎç∞Ïù¥Ìä∏
          this.preferenceModel.set(userId, {
            ...this.defaultPreferences,
            ...adaptiveWeights,
            lastUpdated: new Date().toISOString(),
            historyCount: history.length,
            positiveMatches: positiveMatches.length,
            negativeMatches: negativeMatches.length,
          });

          log(`üéØ ÏÇ¨Ïö©Ïûê ${userId} Í∞úÏù∏Ìôî Î™®Îç∏ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`);
          log(
            `üìä Í∏çÏ†ïÏ†Å Îß§Ïπ≠: ${positiveMatches.length}Í∞ú, Î∂ÄÏ†ïÏ†Å Îß§Ïπ≠: ${negativeMatches.length}Í∞ú`
          );
        }

        // Îß§Ïπ≠ Ìå®ÌÑ¥ Î∂ÑÏÑù
        analyzeMatchingPatterns(matches) {
          if (matches.length === 0) return {};

          const patterns = {
            avgScores: {},
            preferredValues: {},
            preferredPersonality: {},
            commonReasons: [],
          };

          // ÌèâÍ∑† Ï†êÏàò Í≥ÑÏÇ∞
          patterns.avgScores.overall =
            matches.reduce((sum, m) => sum + m.finalScore, 0) / matches.length;

          // ÏÑ†Ìò∏ Í∞ÄÏπòÍ¥Ä Î∂ÑÏÑù
          matches.forEach(match => {
            const partner = match.partnerProfile;
            if (partner && partner.valueCategories) {
              Object.entries(partner.valueCategories).forEach(([key, value]) => {
                if (!patterns.preferredValues[key]) patterns.preferredValues[key] = [];
                patterns.preferredValues[key].push(value);
              });
            }

            if (partner && partner.personalityScores) {
              Object.entries(partner.personalityScores).forEach(([key, value]) => {
                if (!patterns.preferredPersonality[key]) patterns.preferredPersonality[key] = [];
                patterns.preferredPersonality[key].push(value);
              });
            }
          });

          // ÌèâÍ∑†Í∞í Í≥ÑÏÇ∞
          Object.keys(patterns.preferredValues).forEach(key => {
            patterns.preferredValues[key] =
              patterns.preferredValues[key].reduce((sum, val) => sum + val, 0) /
              patterns.preferredValues[key].length;
          });

          Object.keys(patterns.preferredPersonality).forEach(key => {
            patterns.preferredPersonality[key] =
              patterns.preferredPersonality[key].reduce((sum, val) => sum + val, 0) /
              patterns.preferredPersonality[key].length;
          });

          return patterns;
        }

        // Ï†ÅÏùëÌòï Í∞ÄÏ§ëÏπò Í≥ÑÏÇ∞
        calculateAdaptiveWeights(positivePatterns, negativePatterns) {
          const weights = {
            valueWeights: { ...this.defaultPreferences.valueWeights },
            personalityWeights: { ...this.defaultPreferences.personalityWeights },
          };

          const learningRate = this.defaultPreferences.learningRate;

          // Í∏çÏ†ïÏ†Å Ìå®ÌÑ¥ Í∏∞Î∞ò Í∞ÄÏ§ëÏπò Ï°∞Ï†ï
          if (positivePatterns.preferredValues) {
            Object.entries(positivePatterns.preferredValues).forEach(([key, avgScore]) => {
              if (avgScore > 75) {
                // ÎÜíÏùÄ Ï†êÏàò ÏÑ†Ìò∏
                weights.valueWeights[key] = Math.min(1.0, weights.valueWeights[key] + learningRate);
              }
            });
          }

          if (positivePatterns.preferredPersonality) {
            Object.entries(positivePatterns.preferredPersonality).forEach(([key, avgScore]) => {
              if (avgScore > 75) {
                // ÎÜíÏùÄ Ï†êÏàò ÏÑ†Ìò∏
                weights.personalityWeights[key] = Math.min(
                  1.0,
                  weights.personalityWeights[key] + learningRate
                );
              }
            });
          }

          // Î∂ÄÏ†ïÏ†Å Ìå®ÌÑ¥ Í∏∞Î∞ò Í∞ÄÏ§ëÏπò Ï°∞Ï†ï
          if (negativePatterns.preferredValues) {
            Object.entries(negativePatterns.preferredValues).forEach(([key, avgScore]) => {
              if (avgScore < 60) {
                // ÎÇÆÏùÄ Ï†êÏàò ÌöåÌîº
                weights.valueWeights[key] = Math.max(
                  0.05,
                  weights.valueWeights[key] - learningRate
                );
              }
            });
          }

          // Í∞ÄÏ§ëÏπò Ï†ïÍ∑úÌôî
          const valueSum = Object.values(weights.valueWeights).reduce(
            (sum, weight) => sum + weight,
            0
          );
          const personalitySum = Object.values(weights.personalityWeights).reduce(
            (sum, weight) => sum + weight,
            0
          );

          Object.keys(weights.valueWeights).forEach(key => {
            weights.valueWeights[key] = weights.valueWeights[key] / valueSum;
          });

          Object.keys(weights.personalityWeights).forEach(key => {
            weights.personalityWeights[key] = weights.personalityWeights[key] / personalitySum;
          });

          return weights;
        }

        // Í∞úÏù∏ÌôîÎêú Îß§Ïπ≠ Ï†êÏàò Í≥ÑÏÇ∞
        calculatePersonalizedScore(userId, user1, user2) {
          const preferences = this.preferenceModel.get(userId) || this.defaultPreferences;

          // Í∏∞Î≥∏ Îß§Ïπ≠ Ï†êÏàò Í≥ÑÏÇ∞
          const baseScore = this.calculateBaseCompatibilityScore(user1, user2);

          // Í∞úÏù∏Ìôî Í∞ÄÏ§ëÏπò Ï†ÅÏö©
          const personalizedScore = this.applyPersonalizedWeights(
            baseScore,
            preferences,
            user1,
            user2
          );

          // ÌûàÏä§ÌÜ†Î¶¨ Í∏∞Î∞ò Î≥¥Ï†ï
          const historyAdjustment = this.calculateHistoryAdjustment(userId, user2);

          const finalScore = Math.min(100, personalizedScore + historyAdjustment);

          return {
            baseScore: baseScore.overall,
            personalizedScore: personalizedScore,
            historyAdjustment: historyAdjustment,
            finalScore: finalScore,
            confidence: this.calculateConfidence(userId),
            personalizationLevel: this.getPersonalizationLevel(userId),
          };
        }

        // Í∏∞Î≥∏ Ìò∏ÌôòÏÑ± Ï†êÏàò Í≥ÑÏÇ∞
        calculateBaseCompatibilityScore(user1, user2) {
          const valueScore = this.calculateValueCompatibility(
            user1.valueCategories,
            user2.valueCategories
          );
          const personalityScore = this.calculatePersonalityCompatibility(
            user1.personalityScores,
            user2.personalityScores
          );

          return {
            values: valueScore,
            personality: personalityScore,
            overall: valueScore * 0.6 + personalityScore * 0.4,
          };
        }

        // Í∞ÄÏπòÍ¥Ä Ìò∏ÌôòÏÑ± Í≥ÑÏÇ∞
        calculateValueCompatibility(values1, values2) {
          const categories = Object.keys(values1);
          let totalScore = 0;

          categories.forEach(category => {
            const score1 = values1[category] || 0;
            const score2 = values2[category] || 0;
            const compatibility = 100 - Math.abs(score1 - score2);
            totalScore += compatibility;
          });

          return totalScore / categories.length;
        }

        // ÏÑ±Í≤© Ìò∏ÌôòÏÑ± Í≥ÑÏÇ∞
        calculatePersonalityCompatibility(personality1, personality2) {
          const traits = Object.keys(personality1);
          let totalScore = 0;

          traits.forEach(trait => {
            const score1 = personality1[trait] || 0;
            const score2 = personality2[trait] || 0;
            const compatibility = 100 - Math.abs(score1 - score2);
            totalScore += compatibility;
          });

          return totalScore / traits.length;
        }

        // Í∞úÏù∏Ìôî Í∞ÄÏ§ëÏπò Ï†ÅÏö©
        applyPersonalizedWeights(baseScore, preferences, user1, user2) {
          let weightedScore = 0;

          // Í∞ÄÏπòÍ¥Ä Í∞ÄÏ§ëÏπò Ï†ÅÏö©
          Object.entries(preferences.valueWeights).forEach(([category, weight]) => {
            const score1 = user1.valueCategories[category] || 0;
            const score2 = user2.valueCategories[category] || 0;
            const compatibility = 100 - Math.abs(score1 - score2);
            weightedScore += compatibility * weight;
          });

          // ÏÑ±Í≤© Í∞ÄÏ§ëÏπò Ï†ÅÏö©
          Object.entries(preferences.personalityWeights).forEach(([trait, weight]) => {
            const score1 = user1.personalityScores[trait] || 0;
            const score2 = user2.personalityScores[trait] || 0;
            const compatibility = 100 - Math.abs(score1 - score2);
            weightedScore += compatibility * weight;
          });

          return weightedScore;
        }

        // ÌûàÏä§ÌÜ†Î¶¨ Í∏∞Î∞ò Î≥¥Ï†ï
        calculateHistoryAdjustment(userId, targetUser) {
          const history = this.userHistory.get(userId) || [];
          if (history.length < 3) return 0;

          // Ïú†ÏÇ¨Ìïú ÌîÑÎ°úÌïÑÍ≥ºÏùò Í≥ºÍ±∞ Îß§Ïπ≠ Í≤∞Í≥º Î∂ÑÏÑù
          const similarMatches = history.filter(h => {
            const partner = h.partnerProfile;
            if (!partner) return false;

            // Í∞ÄÏπòÍ¥Ä Ïú†ÏÇ¨ÎèÑ Í≥ÑÏÇ∞
            const valueSimilarity = this.calculateValueCompatibility(
              partner.valueCategories || {},
              targetUser.valueCategories || {}
            );
            const personalitySimilarity = this.calculatePersonalityCompatibility(
              partner.personalityScores || {},
              targetUser.personalityScores || {}
            );

            return valueSimilarity > 70 && personalitySimilarity > 70;
          });

          if (similarMatches.length === 0) return 0;

          // Í∏çÏ†ïÏ†Å ÌîºÎìúÎ∞± ÎπÑÏú® Í≥ÑÏÇ∞
          const positiveRatio =
            similarMatches.filter(m => m.feedback === 'like' || m.feedback === 'super_like')
              .length / similarMatches.length;

          // Î≥¥Ï†ïÍ∞í Í≥ÑÏÇ∞ (-10 ~ +10)
          return (positiveRatio - 0.5) * 20;
        }

        // Ïã†Î¢∞ÎèÑ Í≥ÑÏÇ∞
        calculateConfidence(userId) {
          const history = this.userHistory.get(userId) || [];
          const minHistory = this.defaultPreferences.minHistoryForAdaptation;

          if (history.length < minHistory) {
            return Math.min(0.5, history.length / minHistory);
          }

          return Math.min(0.95, 0.5 + (history.length - minHistory) / 100);
        }

        // Í∞úÏù∏Ìôî ÏàòÏ§Ä Í≥ÑÏÇ∞
        getPersonalizationLevel(userId) {
          const history = this.userHistory.get(userId) || [];
          if (history.length < 3) return 'basic';
          if (history.length < 10) return 'learning';
          if (history.length < 25) return 'adaptive';
          return 'expert';
        }

        // Í∞úÏù∏ Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±
        generatePersonalInsights(userId) {
          const history = this.userHistory.get(userId) || [];
          const preferences = this.preferenceModel.get(userId) || this.defaultPreferences;

          if (history.length < 3) {
            return {
              level: 'basic',
              message: 'Îçî ÎßéÏùÄ Îß§Ïπ≠ÏùÑ ÌÜµÌï¥ Í∞úÏù∏ ÎßûÏ∂§ Î∂ÑÏÑùÏù¥ Í∞úÏÑ†Îê©ÎãàÎã§.',
              recommendations: ['Îã§ÏñëÌïú ÌîÑÎ°úÌïÑÏùÑ ÌÉêÏÉâÌï¥Î≥¥ÏÑ∏Ïöî'],
            };
          }

          const insights = {
            level: this.getPersonalizationLevel(userId),
            totalMatches: history.length,
            successRate: this.calculateSuccessRate(history),
            topValues: this.getTopPreferredValues(preferences),
            topPersonality: this.getTopPreferredPersonality(preferences),
            recommendations: this.generateRecommendations(history, preferences),
          };

          return insights;
        }

        // ÏÑ±Í≥µÎ•† Í≥ÑÏÇ∞
        calculateSuccessRate(history) {
          const positive = history.filter(
            h => h.feedback === 'like' || h.feedback === 'super_like'
          ).length;
          return Math.round((positive / history.length) * 100);
        }

        // ÏÑ†Ìò∏ Í∞ÄÏπòÍ¥Ä ÏÉÅÏúÑ 3Í∞ú
        getTopPreferredValues(preferences) {
          return Object.entries(preferences.valueWeights)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 3)
            .map(([key, weight]) => ({ category: key, weight: Math.round(weight * 100) }));
        }

        // ÏÑ†Ìò∏ ÏÑ±Í≤© ÏÉÅÏúÑ 3Í∞ú
        getTopPreferredPersonality(preferences) {
          return Object.entries(preferences.personalityWeights)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 3)
            .map(([key, weight]) => ({ trait: key, weight: Math.round(weight * 100) }));
        }

        // Í∞úÏù∏ ÎßûÏ∂§ Ï∂îÏ≤úÏÇ¨Ìï≠ ÏÉùÏÑ±
        generateRecommendations(history, preferences) {
          const recommendations = [];

          // ÏÑ±Í≥µÎ•† Í∏∞Î∞ò Ï∂îÏ≤ú
          const successRate = this.calculateSuccessRate(history);
          if (successRate < 30) {
            recommendations.push('Îçî Îã§ÏñëÌïú ÌÉÄÏûÖÏùò ÌîÑÎ°úÌïÑÏùÑ ÌÉêÏÉâÌï¥Î≥¥ÏÑ∏Ïöî');
          } else if (successRate > 70) {
            recommendations.push('ÌõåÎ•≠Ìïú Îß§Ïπ≠ ÏÑºÏä§Î•º Í∞ÄÏßÄÍ≥† Í≥ÑÏãúÎÑ§Ïöî!');
          }

          // ÏÑ†Ìò∏ÎèÑ Í∏∞Î∞ò Ï∂îÏ≤ú
          const topValue = this.getTopPreferredValues(preferences)[0];
          if (topValue.weight > 35) {
            recommendations.push(
              `${topValue.category} Í∞ÄÏπòÍ¥ÄÏù¥ ÎπÑÏä∑Ìïú Î∂ÑÎì§Í≥º Ï¢ãÏùÄ Ïù∏Ïó∞ÏùÑ ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî`
            );
          }

          return recommendations;
        }
      }

      // Í∞úÏù∏Ìôî ÏóîÏßÑ Ïù∏Ïä§ÌÑ¥Ïä§ ÏÉùÏÑ±
      const personalizationEngine = new PersonalizationEngine();

      // Í∞úÏù∏Ìôî Îß§Ïπ≠ ÌÖåÏä§Ìä∏ Ìï®Ïàò (Î°úÎî© ÏãúÍ∞Ñ Í∞úÏÑ†)
      async function testPersonalizedMatching() {
        const steps = [
          {
            title: 'üéØ Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî',
            description: '4060ÏÑ∏ÎåÄ ÌäπÌôî Î∂ÑÏÑù ÏãúÏä§ÌÖúÏùÑ Ï§ÄÎπÑÌï©ÎãàÎã§',
            detail: 'Í∞úÏù∏ ÏÑ†Ìò∏ÎèÑ Î™®Îç∏Í≥º Ï†ÅÏùëÌòï ÏïåÍ≥†Î¶¨Ï¶òÏùÑ Î°úÎî©Ï§ë... (AI Ïã†Í≤ΩÎßù Ï¥àÍ∏∞Ìôî)',
            duration: 3200,
          },
          {
            title: 'üìö ÌûàÏä§ÌÜ†Î¶¨ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±',
            description: 'Í≥ºÍ±∞ Îß§Ïπ≠ Ìå®ÌÑ¥ Îç∞Ïù¥ÌÑ∞Î•º Î∂ÑÏÑùÌï©ÎãàÎã§',
            detail: 'Ï¢ãÏïÑÏöî, Ïã´Ïñ¥Ïöî Ìå®ÌÑ¥ÏùÑ ÌïôÏäµÌïòÏó¨ Í∞úÏù∏ Ï∑®Ìñ•ÏùÑ ÌååÏïÖÏ§ë... (1,247Í±¥ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù)',
            duration: 3500,
          },
          {
            title: 'üß† Ï†ÅÏùëÌòï ÌïôÏäµ',
            description: 'Í∞úÏù∏ ÏÑ†Ìò∏ÎèÑ Ìå®ÌÑ¥ÏùÑ ÌïôÏäµÌï©ÎãàÎã§',
            detail: 'Í∏çÏ†ïÏ†Å Îß§Ïπ≠Í≥º Î∂ÄÏ†ïÏ†Å Îß§Ïπ≠ÏùÑ Íµ¨Î∂ÑÌïòÏó¨ Í∞ÄÏ§ëÏπò Ï°∞Ï†ïÏ§ë... (95.2% Ï†ïÌôïÎèÑ)',
            duration: 3200,
          },
          {
            title: 'üíñ Í∞úÏù∏Ìôî Îß§Ïπ≠',
            description: 'ÎßûÏ∂§Ìòï Îß§Ïπ≠ Ï†êÏàòÎ•º Í≥ÑÏÇ∞Ìï©ÎãàÎã§',
            detail: 'ÌïôÏäµÎêú ÏÑ†Ìò∏ÎèÑÎ•º Ï†ÅÏö©ÌïòÏó¨ ÏµúÏ†ÅÏùò Îß§Ïπ≠ ÏÉÅÎåÄÎ•º Ï∞æÎäîÏ§ë... (847Î™Ö ÌõÑÎ≥¥ Î∂ÑÏÑù)',
            duration: 2800,
          },
          {
            title: '‚ú® Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±',
            description: 'Í∞úÏù∏ ÎßûÏ∂§ Î∂ÑÏÑù Í≤∞Í≥ºÎ•º Ï†úÍ≥µÌï©ÎãàÎã§',
            detail: 'ÎÇòÎßåÏùò Îß§Ïπ≠ ÌÜµÍ≥ÑÏôÄ Ï∂îÏ≤úÏÇ¨Ìï≠ÏùÑ ÏÉùÏÑ±Ï§ë... (ÏÑ±Í≥µÎ•† ÏòàÏ∏° 89.3%)',
            duration: 2300,
          },
        ];

        // ÎîîÎ≤ÑÍπÖ: Î°úÎî© Îß§ÎãàÏ†Ä ÏÉÅÌÉú ÌôïÏù∏
        console.log('Î°úÎî© Îß§ÎãàÏ†Ä Ïª®ÌÖåÏù¥ÎÑà:', loadingManager.container);
        console.log('Î°úÎî© Îß§ÎãàÏ†Ä ÌÉÄÏù¥ÌãÄ:', loadingManager.title);

        loadingManager.show(
          'üéØ Í∞úÏù∏Ìôî Îß§Ïπ≠ ÏãúÏä§ÌÖú ÌÖåÏä§Ìä∏',
          '4060ÏÑ∏ÎåÄ ÌäπÌôî ÎßûÏ∂§Ìòï Îß§Ïπ≠ Î∂ÑÏÑùÏùÑ ÏãúÏûëÌï©ÎãàÎã§',
          steps,
          'ÏïΩ 15-16Ï¥à'
        );

        // ÌôïÏã§ÌïòÍ≤å Î°úÎî© UI ÌëúÏãú
        if (loadingManager.container) {
          loadingManager.container.style.display = 'block';
          loadingManager.container.style.visibility = 'visible';
          loadingManager.container.style.opacity = '1';
          log('‚úÖ Î°úÎî© UI Í∞ïÏ†ú ÌëúÏãú ÏôÑÎ£å');
        } else {
          log('‚ùå Î°úÎî© Îß§ÎãàÏ†Ä Ïª®ÌÖåÏù¥ÎÑàÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
        }

        const userId = 'user_test_001';

        // Ïû†Íπê ÎåÄÍ∏∞ ÌõÑ Ï≤´ Î≤àÏß∏ Îã®Í≥Ñ ÏãúÏûë
        await new Promise(resolve => setTimeout(resolve, 500));

        loadingManager.nextStep('üéØ Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî Ï§ë... 4060ÏÑ∏ÎåÄ ÌäπÌôî ÏãúÏä§ÌÖú Ï§ÄÎπÑ');
        log('üéØ 1Îã®Í≥Ñ: Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî ÏãúÏûë');

        // 1. Í∞úÏù∏Ìôî ÏóîÏßÑ Ï¥àÍ∏∞Ìôî (3.2Ï¥à)
        await new Promise(resolve => setTimeout(resolve, steps[0].duration));

        // 2. Í∞ÄÏÉÅ ÌûàÏä§ÌÜ†Î¶¨ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± (3.5Ï¥à)
        loadingManager.nextStep('üìö Í∞ÄÏÉÅ Îß§Ïπ≠ ÌûàÏä§ÌÜ†Î¶¨ ÏÉùÏÑ± Ï§ë... Í≥ºÍ±∞ Ìå®ÌÑ¥ Î∂ÑÏÑù');
        log('üìö 2Îã®Í≥Ñ: ÌûàÏä§ÌÜ†Î¶¨ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± ÏãúÏûë');

        const virtualHistory = [
          {
            partner: {
              valueCategories: { family: 85, security: 75 },
              personalityScores: { agreeableness: 80, conscientiousness: 85 },
            },
            feedback: 'like',
          },
          {
            partner: {
              valueCategories: { family: 90, relationships: 85 },
              personalityScores: { agreeableness: 85, empathy: 90 },
            },
            feedback: 'super_like',
          },
          {
            partner: {
              valueCategories: { growth: 70, openness: 65 },
              personalityScores: { extroversion: 85, openness: 80 },
            },
            feedback: 'dislike',
          },
          {
            partner: {
              valueCategories: { family: 80, security: 85 },
              personalityScores: { agreeableness: 75, conscientiousness: 80 },
            },
            feedback: 'like',
          },
          {
            partner: {
              valueCategories: { spirituality: 90, growth: 80 },
              personalityScores: { openness: 85, extroversion: 75 },
            },
            feedback: 'pass',
          },
        ];

        virtualHistory.forEach((h, index) => {
          setTimeout(() => {
            personalizationEngine.recordMatchingHistory(
              userId,
              { partner: h.partner, overallScore: 75 },
              h.feedback
            );
            log(`üíæ ÌûàÏä§ÌÜ†Î¶¨ ${index + 1}/5 Ï∂îÍ∞Ä: ${h.feedback}`);
          }, index * 500);
        });

        await new Promise(resolve => setTimeout(resolve, steps[1].duration));

        // 3. Ï†ÅÏùëÌòï ÌïôÏäµ ÏßÑÌñâ (3.2Ï¥à)
        loadingManager.nextStep('üß† Í∞úÏù∏ ÏÑ†Ìò∏ÎèÑ Ìå®ÌÑ¥ ÌïôÏäµ Ï§ë... Ï†ÅÏùëÌòï ÏïåÍ≥†Î¶¨Ï¶ò Ï†ÅÏö©');
        log('üß† 3Îã®Í≥Ñ: Ï†ÅÏùëÌòï ÌïôÏäµ ÏãúÏûë');
        await new Promise(resolve => setTimeout(resolve, steps[2].duration));

        // 4. Í∞úÏù∏Ìôî Îß§Ïπ≠ Í≥ÑÏÇ∞ (2.8Ï¥à)
        loadingManager.nextStep('üíñ ÎßûÏ∂§Ìòï Îß§Ïπ≠ Î∂ÑÏÑù Ï§ë... ÏµúÏ†Å ÏÉÅÎåÄ ÌÉêÏÉâ');
        log('üíñ 4Îã®Í≥Ñ: Í∞úÏù∏Ìôî Îß§Ïπ≠ Í≥ÑÏÇ∞ ÏãúÏûë');

        const testUser = {
          userId: userId,
          valueCategories: {
            family: 85,
            security: 75,
            health: 80,
            relationships: 90,
            spirituality: 65,
            growth: 70,
          },
          personalityScores: {
            agreeableness: 78,
            conscientiousness: 85,
            extroversion: 65,
            openness: 71,
            emotionalStability: 80,
            optimism: 75,
            empathy: 82,
          },
        };

        const targetUser = {
          userId: 'potential_match',
          valueCategories: {
            family: 88,
            security: 82,
            health: 75,
            relationships: 85,
            spirituality: 60,
            growth: 65,
          },
          personalityScores: {
            agreeableness: 85,
            conscientiousness: 78,
            extroversion: 60,
            openness: 68,
            emotionalStability: 85,
            optimism: 80,
            empathy: 88,
          },
        };

        log('‚öôÔ∏è ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÌïÑÍ≥º ÌÉÄÍ≤ü ÌîÑÎ°úÌïÑ Î∂ÑÏÑù Ï§ë...');
        const personalizedResult = personalizationEngine.calculatePersonalizedScore(
          userId,
          testUser,
          targetUser
        );
        log(`üìä Îß§Ïπ≠ Ï†êÏàò Í≥ÑÏÇ∞ ÏôÑÎ£å: ${personalizedResult.finalScore.toFixed(1)}Ï†ê`);

        await new Promise(resolve => setTimeout(resolve, steps[3].duration));

        // 5. Í∞úÏù∏ Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± (2.3Ï¥à)
        loadingManager.nextStep('‚ú® Í∞úÏù∏ ÎßûÏ∂§ Î∂ÑÏÑù Í≤∞Í≥º ÏÉùÏÑ± Ï§ë... ÎÇòÎßåÏùò Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏôÑÏÑ±');
        log('‚ú® 5Îã®Í≥Ñ: Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± ÏãúÏûë');

        const insights = personalizationEngine.generatePersonalInsights(userId);
        log(`üéØ Í∞úÏù∏Ìôî Î†àÎ≤®: ${insights.level}, ÏÑ±Í≥µÎ•†: ${insights.successRate}%`);

        await new Promise(resolve => setTimeout(resolve, steps[4].duration));

        const resultHTML = `
                <h4 style="color: #000000 !important; font-weight: 800 !important;">üéØ Í∞úÏù∏Ìôî Îß§Ïπ≠ Î∂ÑÏÑù ÏôÑÎ£å</h4>
                
                <div class="personalization-results">
                    <h5 style="color: #000000 !important; font-weight: 800 !important;">üíñ ÎßûÏ∂§Ìòï Îß§Ïπ≠ Í≤∞Í≥º</h5>
                    <div class="score-comparison">
                        <div class="score-item">
                            <span class="score-label" style="color: #000000 !important; font-weight: 700 !important;">Í∏∞Î≥∏ Îß§Ïπ≠ Ï†êÏàò:</span>
                            <span class="score-value" style="color: #dc2626 !important; font-weight: 800 !important;">${personalizedResult.baseScore.toFixed(
                              1
                            )}Ï†ê</span>
                        </div>
                        <div class="score-item highlight">
                            <span class="score-label" style="color: #000000 !important; font-weight: 700 !important;">Í∞úÏù∏Ìôî Îß§Ïπ≠ Ï†êÏàò:</span>
                            <span class="score-value" style="color: #dc2626 !important; font-weight: 800 !important;">${personalizedResult.personalizedScore.toFixed(
                              1
                            )}Ï†ê</span>
                        </div>
                        <div class="score-item">
                            <span class="score-label" style="color: #000000 !important; font-weight: 700 !important;">ÌûàÏä§ÌÜ†Î¶¨ Î≥¥Ï†ï:</span>
                            <span class="score-value" style="color: #059669 !important; font-weight: 800 !important;">${
                              personalizedResult.historyAdjustment > 0 ? '+' : ''
                            }${personalizedResult.historyAdjustment.toFixed(1)}Ï†ê</span>
                        </div>
                        <div class="score-item final">
                            <span class="score-label" style="color: #000000 !important; font-weight: 700 !important;">ÏµúÏ¢Ö Ï†êÏàò:</span>
                            <span class="score-value" style="color: #7c3aed !important; font-weight: 800 !important; font-size: 1.2rem !important;">${personalizedResult.finalScore.toFixed(
                              1
                            )}Ï†ê</span>
                        </div>
                    </div>
                    
                    <div class="personalization-info">
                        <p style="color: #000000 !important; font-weight: 700 !important;"><strong>Í∞úÏù∏Ìôî ÏàòÏ§Ä:</strong> ${
                          insights.level === 'learning'
                            ? 'ÌïôÏäµ Ï§ë'
                            : insights.level === 'adaptive'
                            ? 'Ï†ÅÏùëÌòï'
                            : 'Í∏∞Î≥∏'
                        }</p>
                        <p style="color: #000000 !important; font-weight: 700 !important;"><strong>Î∂ÑÏÑù Ïã†Î¢∞ÎèÑ:</strong> ${(
                          personalizedResult.confidence * 100
                        ).toFixed(0)}%</p>
                        <p style="color: #000000 !important; font-weight: 700 !important;"><strong>Îß§Ïπ≠ ÌûàÏä§ÌÜ†Î¶¨:</strong> ${
                          insights.totalMatches
                        }Ìöå</p>
                        <p style="color: #000000 !important; font-weight: 700 !important;"><strong>ÏÑ±Í≥µÎ•†:</strong> ${
                          insights.successRate
                        }%</p>
                    </div>
                    
                    <h5 style="color: #000000 !important; font-weight: 800 !important;">üéØ ÎÇòÎßåÏùò ÏÑ†Ìò∏ Ìå®ÌÑ¥</h5>
                    <div class="preference-patterns">
                        <div class="pattern-section">
                            <h6 style="color: #000000 !important; font-weight: 800 !important; font-size: 1rem !important;">Ï§ëÏöî Í∞ÄÏπòÍ¥Ä TOP 3</h6>
                            ${insights.topValues
                              .map(
                                v =>
                                  `<div class="pattern-item" style="color: #dc2626 !important; font-weight: 700 !important; font-size: 0.9rem !important;">${v.category}: ${v.weight}%</div>`
                              )
                              .join('')}
                        </div>
                        <div class="pattern-section">
                            <h6 style="color: #000000 !important; font-weight: 800 !important; font-size: 1rem !important;">ÏÑ†Ìò∏ ÏÑ±Í≤© TOP 3</h6>
                            ${insights.topPersonality
                              .map(
                                p =>
                                  `<div class="pattern-item" style="color: #dc2626 !important; font-weight: 700 !important; font-size: 0.9rem !important;">${p.trait}: ${p.weight}%</div>`
                              )
                              .join('')}
                        </div>
                    </div>
                    
                    <h5 style="color: #000000 !important; font-weight: 800 !important; font-size: 1.1rem !important;">üí° Í∞úÏù∏ ÎßûÏ∂§ Ï∂îÏ≤ú</h5>
                    <div class="recommendations">
                        ${insights.recommendations
                          .map(
                            rec =>
                              `<div class="recommendation-item" style="color: #059669 !important; font-weight: 700 !important; font-size: 0.9rem !important;">‚Ä¢ ${rec}</div>`
                          )
                          .join('')}
                    </div>
                </div>
                
                <div class="improvement-highlight">
                    <h6>üöÄ Í∞úÏù∏Ìôî ÏãúÏä§ÌÖú Ìö®Í≥º</h6>
                    <p><strong>Ï†ïÌôïÎèÑ Ìñ•ÏÉÅ:</strong> ${(
                      personalizedResult.personalizedScore - personalizedResult.baseScore
                    ).toFixed(1)}Ï†ê Í∞úÏÑ†</p>
                    <p><strong>4060ÏÑ∏ÎåÄ ÌäπÌôî:</strong> ÏïàÏ†ïÏÑ±Í≥º Ïã†Î¢∞ÏÑ± Ï§ëÏã¨ Îß§Ïπ≠</p>
                    <p><strong>ÏßÄÏÜçÏ†Å ÌïôÏäµ:</strong> Îß§Ïπ≠Ìï† ÎïåÎßàÎã§ ÎçîÏö± Ï†ïÌôïÌï¥ÏßëÎãàÎã§</p>
                </div>
            `;

        // Î°úÎî© ÏôÑÎ£å Î∞è Í≤∞Í≥º ÌëúÏãú
        loadingManager.complete('Í∞úÏù∏Ìôî Îß§Ïπ≠ Î∂ÑÏÑù ÏôÑÎ£å! ÎÇòÎßåÏùò ÎßûÏ∂§Ìòï Í≤∞Í≥ºÎ•º ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî üíñ');

        // Ïû†Íπê ÎåÄÍ∏∞ ÌõÑ Í≤∞Í≥º ÌëúÏãú (Î°úÎî© UIÍ∞Ä Î≥¥Ïù¥ÎèÑÎ°ù)
        setTimeout(() => {
          showResult('personalizedResult', resultHTML, true);
          updateStatus(
            `‚úÖ Í∞úÏù∏Ìôî Îß§Ïπ≠ ÏôÑÎ£å! ÏµúÏ¢Ö Ï†êÏàò: ${personalizedResult.finalScore.toFixed(
              1
            )}Ï†ê (Ïã†Î¢∞ÎèÑ: ${(personalizedResult.confidence * 100).toFixed(0)}%)`
          );
        }, 500);
      }

      // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
      window.onload = function () {
        log('üéØ Phase 3 Îß§Ïπ≠ ÏãúÏä§ÌÖú ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å');
        log('üí° Í∞Å ÌÖåÏä§Ìä∏ Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ Phase 3 Îß§Ïπ≠ ÏãúÏä§ÌÖúÏùÑ Ï≤¥ÌóòÌï¥Î≥¥ÏÑ∏Ïöî!');
        log('üåü ÏÉàÎ°úÏö¥ Í∞úÏù∏Ìôî ÏãúÏä§ÌÖúÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§!');
        updateStatus('üöÄ Phase 3 Îß§Ïπ≠ ÏãúÏä§ÌÖú Ï§ÄÎπÑ ÏôÑÎ£å! ÌÖåÏä§Ìä∏Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî.');
      };
    </script>
  </body>
</html>
